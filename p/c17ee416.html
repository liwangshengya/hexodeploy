<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>numpy基础用法 | 忘生的blog</title><meta name="author" content="李忘生"><meta name="copyright" content="李忘生"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="后面原文件内容来自datawhalechina&amp;#x2F;powerful-numpy: 巨硬的NumPy (github.com) 基本操作 这部分是在看下面的教程中，自己跟着写的一些代码。如果学习的化直接看第二部分。 导包 1import numpy as np 从列表或元组中创建 123a&amp;#x3D;np.arr"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://hexo.chunyang.eu.org/p/c17ee416"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="i24Uqg-I5HEqTER0wNyJc72O8Tr4wvAUMnyl6HbUI38"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: {"appId":"GQI1E1W197","apiKey":"e87ab2563de562be49f9ae8786744569","indexName":"my-hexo-blog","hits":{"per_page":6},"languages":{"input_placeholder":"搜索文章","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":500,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'numpy基础用法',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-09-07 20:10:40'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/liwangsheng.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">52</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">忘生的blog</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">numpy基础用法</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-02-04T02:45:05.000Z" title="发表于 2022-02-04 10:45:05">2022-02-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-09-07T12:10:40.231Z" title="更新于 2022-09-07 20:10:40">2022-09-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97%E5%BA%93/">科学计算库</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">13.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>60分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="numpy基础用法"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>后面原文件内容来自<a target="_blank" rel="noopener" href="https://github.com/datawhalechina/powerful-numpy">datawhalechina/powerful-numpy: 巨硬的NumPy (github.com)</a></p>
<h1>基本操作</h1>
<p>这部分是在看下面的教程中，自己跟着写的一些代码。如果学习的化直接看第二部分。</p>
<h5 id="导包">导包</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>
<h5 id="从列表或元组中创建">从列表或元组中创建</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a=np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])<span class="comment">#一维</span></span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[1 2 3]</span><br></pre></td></tr></table></figure>
<h5 id="使用arange生成">使用arange生成</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">b=np.array(<span class="built_in">range</span>(<span class="number">1</span>,<span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line">c=np.arange(<span class="number">1</span>,<span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line">d=np.arange(<span class="number">1</span>,<span class="number">6</span>,<span class="number">2</span>)<span class="comment">#2为步长</span></span><br><span class="line"><span class="built_in">print</span>(d)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[1 2 3 4 5]</span><br><span class="line">[1 2 3 4 5]</span><br><span class="line">[1 3 5]</span><br></pre></td></tr></table></figure>
<h5 id="使用linespace-logspace生成">使用linespace/logspace生成</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.linspace(<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>)<span class="comment">#开头，结尾，数量</span></span><br></pre></td></tr></table></figure>
<pre><code>array([0., 1., 2., 3., 4., 5., 6., 7., 8., 9.])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.linspace(<span class="number">0</span>,<span class="number">9</span>,<span class="number">7</span>)<span class="comment">#是一种线性的等差数列</span></span><br></pre></td></tr></table></figure>
<pre><code>array([0. , 1.5, 3. , 4.5, 6. , 7.5, 9. ])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.logspace(<span class="number">0</span>,<span class="number">9</span>,<span class="number">6</span>,base=np.e)<span class="comment">#需要额外添加一个base，默认为10</span></span><br></pre></td></tr></table></figure>
<pre><code>array([1.00000000e+00, 6.04964746e+00, 3.65982344e+01, 2.21406416e+02,
       1.33943076e+03, 8.10308393e+03])
</code></pre>
<h5 id="数组形状">数组形状</h5>
<p>.shape来查看数组形状<br>
reshape 修改数组形状</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1=np.arange(<span class="number">1</span>,<span class="number">13</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1</span><br><span class="line">array([ <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1.shape<span class="comment">#一维数组</span></span><br><span class="line">(<span class="number">12</span>,)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t2=np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t2</span><br><span class="line">array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">       [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t2.shape<span class="comment">#二维数组</span></span><br><span class="line">(<span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1</span><br><span class="line">array([ <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1.reshape((<span class="number">3</span>,<span class="number">4</span>))<span class="comment">#将t1转换为3行4列的数组</span></span><br><span class="line">array([[ <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>],</span><br><span class="line">       [ <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>],</span><br><span class="line">       [ <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1.reshape((<span class="number">3</span>,-<span class="number">1</span>))<span class="comment">#-1表示自动计算每行应该有多少列</span></span><br><span class="line">array([[ <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>],</span><br><span class="line">       [ <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>],</span><br><span class="line">       [ <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>]])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1</span><br><span class="line">array([ <span class="number">1</span>,  <span class="number">2</span>,  <span class="number">3</span>,  <span class="number">4</span>,  <span class="number">5</span>,  <span class="number">6</span>,  <span class="number">7</span>,  <span class="number">8</span>,  <span class="number">9</span>, <span class="number">10</span>, <span class="number">11</span>, <span class="number">12</span>])</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>t1.reshape((-<span class="number">1</span>,<span class="number">1</span>))<span class="comment">#将数组转换为一列</span></span><br><span class="line">array([[ <span class="number">1</span>],</span><br><span class="line">       [ <span class="number">2</span>],</span><br><span class="line">       [ <span class="number">3</span>],</span><br><span class="line">       [ <span class="number">4</span>],</span><br><span class="line">       [ <span class="number">5</span>],</span><br><span class="line">       [ <span class="number">6</span>],</span><br><span class="line">       [ <span class="number">7</span>],</span><br><span class="line">       [ <span class="number">8</span>],</span><br><span class="line">       [ <span class="number">9</span>],</span><br><span class="line">       [<span class="number">10</span>],</span><br><span class="line">       [<span class="number">11</span>],</span><br><span class="line">       [<span class="number">12</span>]])</span><br></pre></td></tr></table></figure>
<h5 id="one-zeros创建">one/zeros创建</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.ones(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([1., 1., 1.])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.ones((<span class="number">2</span>,<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[1., 1., 1.],
       [1., 1., 1.]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.zeros((<span class="number">3</span>,<span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[0., 0.],
       [0., 0.],
       [0., 0.]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#np.zeros_like 或 np.ones_like，二者可以快速生成给定 array 一样 shape 的 0 或 1 向量</span></span><br><span class="line">a=np.array([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">2</span>,<span class="number">3</span>]])</span><br><span class="line"><span class="built_in">print</span>(np.zeros_like(a))</span><br><span class="line">np.ones_like(a)</span><br></pre></td></tr></table></figure>
<pre><code>[[0 0]
 [0 0]]





array([[1, 1],
       [1, 1]])
</code></pre>
<h5 id="使用random生成">使用random生成</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#0-1均匀分布</span></span><br><span class="line">np.random.rand(<span class="number">2</span>,<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">array([[0.42926805, 0.43072106, 0.53702462],</span><br><span class="line">      [0.89851387, 0.18539595, 0.42793225]])</span><br></pre></td></tr></table></figure>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#单个数</span></span><br><span class="line"> np.random.rand()</span><br></pre></td></tr></table></figure>
<p>0.36071062769229123</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#指定上下界的均匀分布</span></span><br><span class="line">np.random.uniform(-<span class="number">1</span>,<span class="number">1</span>,(<span class="number">2</span>,<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<p>array([[-0.64544541, -0.25383872,  0.1808275 ],<br>
[-0.43496897, -0.80391586,  0.06209736]])</p>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#通过 np.random.default_rng() 先生成 Generator，然后再在此基础上生成各种分布的数据（记忆更加简便清晰）。</span></span><br><span class="line">rng=np.random.default_rng(<span class="number">1</span>)<span class="comment">#1是种子</span></span><br><span class="line">rng</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Generator(PCG64) at 0x22AEFEE74A0</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rng.random((<span class="number">2</span>,<span class="number">3</span>))<span class="comment">#均匀分布</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">array([[0.51182162, 0.9504637 , 0.14415961],</span><br><span class="line">      [0.94864945, 0.31183145, 0.42332645]])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rng.uniform(-<span class="number">1</span>,<span class="number">1</span>,(<span class="number">3</span>,<span class="number">2</span>))<span class="comment">#指定上下界的均匀分布</span></span><br></pre></td></tr></table></figure>
<pre><code> array([[ 0.65540519, -0.18160173],
        [ 0.09918738, -0.94488177],
        [ 0.50702622,  0.07628663]])
</code></pre>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 随机整数（离散均匀分布），不超过给定的值（10）</span></span><br><span class="line">np.random.randint(<span class="number">10</span>, size=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<pre><code> array([1, 2])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 随机整数（离散均匀分布），指定上下界和 shape</span></span><br><span class="line">np.random.randint(<span class="number">0</span>, <span class="number">10</span>, (<span class="number">2</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code> array([[8, 9, 1],
        [2, 6, 1]])
</code></pre>
 <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#标准正态分布</span></span><br><span class="line">np.random.rand(<span class="number">2</span>,<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">array([[0.13697705, 0.16495722, 0.7386519 , 0.30595425],</span><br><span class="line">       [0.53560286, 0.06430746, 0.90285721, 0.47987077]])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#高斯分布</span></span><br><span class="line">np.random.normal(<span class="number">0</span>,<span class="number">1</span>,(<span class="number">3</span>,<span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<pre><code> array([[ 1.12032801, -0.89480603,  0.90740065,  1.72309526],
        [ 0.11032696,  0.15336619, -0.60820831, -0.08424255],
        [-0.29166234, -0.80346217,  0.48008174,  0.7266655 ]])
</code></pre>
<h5 id="求平均值和标准差">求平均值和标准差</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr=np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]])</span><br><span class="line">np.average(arr)<span class="comment">#求平均值</span></span><br></pre></td></tr></table></figure>
<pre><code>5.0
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.average(arr,axis=<span class="number">0</span>)<span class="comment">#按列求平均</span></span><br></pre></td></tr></table></figure>
<pre><code>array([4., 5., 6.])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.average(arr,axis=<span class="number">1</span>)<span class="comment">#按行求平均</span></span><br></pre></td></tr></table></figure>
<pre><code>array([2., 5., 8.])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr.<span class="built_in">sum</span>(axis=<span class="number">1</span>)<span class="comment">#按行求和</span></span><br></pre></td></tr></table></figure>
<pre><code>array([ 6, 15, 24])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.<span class="built_in">sum</span>(arr,axis=<span class="number">0</span>)<span class="comment">#按列求和</span></span><br></pre></td></tr></table></figure>
<pre><code>array([12, 15, 18])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.mean(arr)<span class="comment">#另一种求平均值</span></span><br></pre></td></tr></table></figure>
<pre><code>5.0
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.std(arr)<span class="comment">#标准差</span></span><br></pre></td></tr></table></figure>
<pre><code>2.581988897471611
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.var(arr)<span class="comment">#方差 标准差和方差用法与平均值的类似，都可以按行或按列求和</span></span><br></pre></td></tr></table></figure>
<pre><code>6.666666666666667
</code></pre>
<h5 id="反序和转置">反序和转置</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#字符串</span></span><br><span class="line">s=<span class="string">&quot;abcdef&quot;</span></span><br><span class="line">s[::-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>'fedcba'
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数组</span></span><br><span class="line"><span class="built_in">list</span>=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"><span class="built_in">list</span>[::-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>[4, 3, 2, 1]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr.T</span><br></pre></td></tr></table></figure>
<pre><code>array([[1, 4, 7],
       [2, 5, 8],
       [3, 6, 9]])
</code></pre>
<h5 id="分解和组合">分解和组合</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=np.random.rand(<span class="number">3</span>,<span class="number">4</span>)</span><br><span class="line">a</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.28316861, 0.76199416, 0.91081204, 0.19720986],
       [0.50787399, 0.78146294, 0.60943133, 0.93976186],
       [0.55123214, 0.60483931, 0.36117639, 0.38412533]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b=np.ones((a.shape[<span class="number">0</span>],<span class="number">1</span>))</span><br><span class="line">c=np.ones((<span class="number">1</span>,a.shape[<span class="number">1</span>]))</span><br><span class="line"><span class="built_in">print</span>(b,c)</span><br></pre></td></tr></table></figure>
<pre><code>[[1.]
 [1.]
 [1.]] [[1. 1. 1. 1.]]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#默认axis=0 按列拼接</span></span><br><span class="line">np.concatenate((a,c))</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.28316861, 0.76199416, 0.91081204, 0.19720986],
       [0.50787399, 0.78146294, 0.60943133, 0.93976186],
       [0.55123214, 0.60483931, 0.36117639, 0.38412533],
       [1.        , 1.        , 1.        , 1.        ]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.concatenate((a,b),axis=<span class="number">1</span>)<span class="comment">#按行拼接</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[0.28316861, 0.76199416, 0.91081204, 0.19720986, 1.        ],
       [0.50787399, 0.78146294, 0.60943133, 0.93976186, 1.        ],
       [0.55123214, 0.60483931, 0.36117639, 0.38412533, 1.        ]])
</code></pre>
<h5 id="拆分">拆分</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#拆分</span></span><br><span class="line">arr=np.random.rand(<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.83040698, 0.86874681, 0.32073868],
       [0.84843869, 0.94233061, 0.57501876],
       [0.34525372, 0.9804726 , 0.11702269],
       [0.75533314, 0.97914285, 0.10175191]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.split(arr,<span class="number">4</span>)<span class="comment">#默认axis=0按列切分</span></span><br></pre></td></tr></table></figure>
<pre><code>[array([[0.83040698, 0.86874681, 0.32073868]]),
 array([[0.84843869, 0.94233061, 0.57501876]]),
 array([[0.34525372, 0.9804726 , 0.11702269]]),
 array([[0.75533314, 0.97914285, 0.10175191]])]
</code></pre>
<h5 id="筛选和过滤">筛选和过滤</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#筛选和过滤</span></span><br><span class="line">arr=np.random.randint(<span class="number">1</span>,<span class="number">100</span>,(<span class="number">3</span>,<span class="number">4</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[44, 83, 40, 85],
       [70, 96, 22, 78],
       [71, 24, 87, 59]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr&gt;<span class="number">60</span><span class="comment">#条件筛选</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[False,  True, False,  True],
       [ True,  True, False,  True],
       [ True, False,  True, False]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">np.where(arr&gt;<span class="number">60</span>)<span class="comment">#</span></span><br><span class="line"><span class="comment">## 返回满足条件的索引，因为是两个维度，所以会返回两组结果</span></span><br></pre></td></tr></table></figure>
<pre><code>(array([0, 0, 1, 1, 1, 2, 2], dtype=int64),
 array([1, 3, 0, 1, 3, 0, 2], dtype=int64))
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不满足条件的赋值，将 &lt;=60 的替换为 -1</span></span><br><span class="line">np.where(arr &gt; <span class="number">60</span>, arr, -<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[-1, 83, -1, 85],
       [70, 96, -1, 78],
       [71, -1, 87, -1]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#np.nonzero 可以起到与where相同的作用</span></span><br><span class="line">np.nonzero(arr&gt;<span class="number">60</span>)</span><br></pre></td></tr></table></figure>
<pre><code>(array([0, 0, 1, 1, 1, 2, 2], dtype=int64),
 array([1, 3, 0, 1, 3, 0, 2], dtype=int64))
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">index=np.nonzero(arr&gt;<span class="number">60</span>)</span><br><span class="line">arr[index]=<span class="number">1</span><span class="comment">#大于60的设置为1</span></span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[44,  1, 40,  1],
       [ 1,  1, 22,  1],
       [ 1, 24,  1, 59]])
</code></pre>
<h5 id="最值索引">最值索引</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 最值索引</span></span><br><span class="line">arr=np.random.uniform(<span class="number">1</span>,<span class="number">100</span>,(<span class="number">4</span>,<span class="number">3</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[97.8734874 , 39.23597617, 37.72185051],
       [47.83484032, 27.14324385, 70.51344464],
       [68.39641974, 68.26842052, 26.72485587],
       [72.27555183, 46.34734565, 12.28779778]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.argmax(arr)<span class="comment">#返回最大值的index</span></span><br></pre></td></tr></table></figure>
<pre><code>0
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.argmax(arr,axis=<span class="number">0</span>)<span class="comment">#按列</span></span><br></pre></td></tr></table></figure>
<pre><code>array([0, 2, 1], dtype=int64)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.argmax(arr,axis=<span class="number">1</span>)<span class="comment">#按行</span></span><br></pre></td></tr></table></figure>
<pre><code>array([0, 2, 0, 0], dtype=int64)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.argsort(arr)<span class="comment">#默认axis=1按行排序</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[2, 1, 0],
       [1, 0, 2],
       [2, 1, 0],
       [2, 1, 0]], dtype=int64)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.argsort(arr,axis=<span class="number">0</span>)<span class="comment">#按列</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[1, 1, 3],
       [2, 0, 2],
       [3, 3, 0],
       [0, 2, 1]], dtype=int64)
</code></pre>
<h5 id="矩阵运算">矩阵运算</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr=np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]])</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[1, 2, 3],
       [4, 5, 6],
       [7, 8, 9]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr*<span class="number">2</span><span class="comment">#+-*/都是对每个数都进行运算</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[ 2,  4,  6],
       [ 8, 10, 12],
       [14, 16, 18]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr**<span class="number">3</span><span class="comment">#立方</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[  1,   8,  27],
       [ 64, 125, 216],
       [343, 512, 729]], dtype=int32)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.sqrt(arr)<span class="comment">#开方</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[1.        , 1.41421356, 1.73205081],
       [2.        , 2.23606798, 2.44948974],
       [2.64575131, 2.82842712, 3.        ]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.log(arr)<span class="comment">#log</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[0.        , 0.69314718, 1.09861229],
       [1.38629436, 1.60943791, 1.79175947],
       [1.94591015, 2.07944154, 2.19722458]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.mod(arr,<span class="number">3</span>)<span class="comment">#模运算</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[1, 2, 0],
       [1, 2, 0],
       [1, 2, 0]], dtype=int32)
</code></pre>
<h5 id="矩阵乘法">矩阵乘法</h5>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a=np.array([[<span class="number">1</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">4</span>],[<span class="number">5</span>,<span class="number">6</span>]])</span><br><span class="line">b=np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],[<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>]])</span><br><span class="line">c=np.array([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>],[<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>]])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#矩阵乘法</span></span><br><span class="line">np.dot(a,b)</span><br></pre></td></tr></table></figure>
<pre><code>array([[11, 14, 17, 20],
       [23, 30, 37, 44],
       [35, 46, 57, 68]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a@b<span class="comment">#等同于.dot</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[11, 14, 17, 20],
       [23, 30, 37, 44],
       [35, 46, 57, 68]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a*a<span class="comment">#点乘</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[ 1,  4],
       [ 9, 16],
       [25, 36]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(np.vdot(a,a))<span class="comment">#点积</span></span><br><span class="line">np.<span class="built_in">sum</span>(a*a)</span><br></pre></td></tr></table></figure>
<pre><code>91

91
</code></pre>
<h1>原文件</h1>
<p>这篇教程是从Github上的，源地址<a target="_blank" rel="noopener" href="https://github.com/datawhalechina/powerful-numpy">datawhalechina/powerful-numpy: 巨硬的NumPy (github.com)</a>，由于ipynb文件在线阅读不方便，就转换成了markdown文件放在这里了，决定写的不错的可以到项目底下点点star支持一下作者。</p>
<p>在学习numpy是把这些代码看一下就行了，用的时候直接查就行了，用多了自然就会了。</p>
<p>本教程内容旨在帮助没有基础的同学快速掌握 <code>numpy</code> 的常用功能，保证日常绝大多数场景的使用。可作为机器学习或深度学习的先修课程，也可作为快速备查手册。</p>
<p>值得一提的是，深度学习的各大框架很多 API 和 <code>numpy</code> 也是一脉相承的哦，可以说 <code>numpy</code> 玩儿熟了，几个深度学习框架的不少 API 也同时学会了。</p>
<p>教程原则如下：</p>
<ul>
<li>偏实用高频 API</li>
<li>展示实际用法</li>
<li>简单直接</li>
</ul>
<p>使用说明如下：</p>
<ul>
<li>每一小节都有⭐（1-5个）表示重要程度，越多越重要</li>
<li>每一小节下重要的会单独列成一个更小的小节，可以通过目录直接访问。其中分割线下面的可以补充了解</li>
<li>⚠️ 表示需要特别注意的</li>
</ul>
<p><strong>特别需要提醒的是</strong>，您在使用的过程中无须过多关注 API 各种参数细节，教程提供的用法足以应付绝大部分场景，更深入的使用方式可以自行根据需要探索或学习后续的《基础教程》。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导入 library</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># 画图工具</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br></pre></td></tr></table></figure>
<h2 id="创建和生成">创建和生成</h2>
<p>本节主要介绍 array 的创建和生成。为什么会把这个放在最前面呢？主要有以下两个方面原因：</p>
<ul>
<li>在实际工作过程中，我们时不时需要验证或查看 array 相关的 API 或互操作。</li>
<li>有时候在使用 sklearn，matplotlib，PyTorch，Tensorflow 等工具时也需要一些简单的数据进行实验。</li>
</ul>
<p>所以，先学会如何快速拿到一个 array 是有很多益处的。本节我们主要介绍以下几种常用的创建方式：</p>
<ul>
<li>使用列表或元组</li>
<li>使用 arange</li>
<li>使用 linspace/logspace</li>
<li>使用 ones/zeros</li>
<li>使用 random</li>
<li>从文件读取</li>
</ul>
<p>其中，最常用的一般是 linspace/logspace 和 random，前者常常用在画坐标轴上，后者则用于生成「模拟数据」。举例来说，当我们需要画一个函数的图像时，X 往往使用 linspace 生成，然后使用函数公式求得 Y，再 plot；当我们需要构造一些输入（比如 X）或中间输入（比如 Embedding、hidden state）时，random 会异常方便。</p>
<h3 id="从-python-列表或元组创建">从 python 列表或元组创建</h3>
<p>⭐⭐ 重点掌握传入 list 创建一个 array 即可：<code>np.array(list)</code></p>
<p>⚠️ 需要注意的是：「数据类型」。如果您足够仔细的话，可以发现下面第二组代码第 2 个数字是「小数」（注：Python 中 1. == 1.0），而 array 是要保证每个元素类型相同的，所以会帮您把 array 转为一个 float 的类型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一个 list</span></span><br><span class="line">np.array([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br></pre></td></tr></table></figure>
<pre><code>array([1, 2, 3])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 二维（多维类似）</span></span><br><span class="line"><span class="comment"># 注意，有一个小数哦</span></span><br><span class="line">np.array([[<span class="number">1</span>, <span class="number">2.</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]])</span><br></pre></td></tr></table></figure>
<pre><code>array([[1., 2., 3.],
       [4., 5., 6.]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 您也可以指定数据类型</span></span><br><span class="line">np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], dtype=np.float16)</span><br></pre></td></tr></table></figure>
<pre><code>array([1., 2., 3.], dtype=float16)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果指定了 dtype，输入的值都会被转为对应的类型，而且不会四舍五入</span></span><br><span class="line">lst = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">    [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6.8</span>]</span><br><span class="line">]</span><br><span class="line">np.array(lst, dtype=np.int32)</span><br></pre></td></tr></table></figure>
<pre><code>array([[1, 2, 3],
       [4, 5, 6]], dtype=int32)
</code></pre>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一个 tuple</span></span><br><span class="line">np.array((<span class="number">1.1</span>, <span class="number">2.2</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([1.1, 2.2])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tuple，一般用 list 就好，不需要使用 tuple</span></span><br><span class="line">np.array([(<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>), (<span class="number">4.4</span>, <span class="number">5.5</span>, <span class="number">6.6</span>)])</span><br></pre></td></tr></table></figure>
<pre><code>array([[1.1, 2.2, 3.3],
       [4.4, 5.5, 6.6]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 转换而不是上面的创建，其实是类似的，无须过于纠结</span></span><br><span class="line">np.asarray((<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([1, 2, 3])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.asarray(([<span class="number">1.</span>, <span class="number">2.</span>, <span class="number">3.</span>], (<span class="number">4.</span>, <span class="number">5.</span>, <span class="number">6.</span>)))</span><br></pre></td></tr></table></figure>
<pre><code>array([[1., 2., 3.],
       [4., 5., 6.]])
</code></pre>
<h3 id="使用-arange-生成">使用 arange 生成</h3>
<p>⭐⭐</p>
<p>range 是 Python 内置的整数序列生成器，arange 是 numpy 的，效果类似，会生成一维的向量。我们偶尔会需要使用这种方式来构造 array，比如：</p>
<ul>
<li>需要创建一个连续一维向量作为输入（比如编码位置时可以使用）</li>
<li>需要观察筛选、抽样的结果时，有序的 array 一般更加容易观察</li>
</ul>
<p>⚠️ 需要注意的是：在 <code>reshape</code> 时，目标的 shape 需要的元素数量一定要和原始的元素数量相等。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.arange(<span class="number">12</span>).reshape(<span class="number">3</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意，是小数哦</span></span><br><span class="line">np.arange(<span class="number">12.0</span>).reshape(<span class="number">4</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 0.,  1.,  2.],
       [ 3.,  4.,  5.],
       [ 6.,  7.,  8.],
       [ 9., 10., 11.]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.arange(<span class="number">100</span>, <span class="number">124</span>, <span class="number">2</span>).reshape(<span class="number">3</span>, <span class="number">2</span>, <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[[100, 102],
        [104, 106]],

       [[108, 110],
        [112, 114]],

       [[116, 118],
        [120, 122]]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># shape size 相乘要和生成的元素数量一致</span></span><br><span class="line">np.arange(<span class="number">100.</span>, <span class="number">124.</span>, <span class="number">2</span>).reshape(<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<pre><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

&lt;ipython-input-20-fc850bf3c646&gt; in &lt;module&gt;
----&gt; 1 np.arange(100., 124., 2).reshape(2,3,4)


ValueError: cannot reshape array of size 12 into shape (2,3,4)
</code></pre>
<h3 id="使用-linspace-logspace-生成">使用 linspace/logspace 生成</h3>
<p>⭐⭐⭐</p>
<p>OK，这是我们遇到的第一个比较重要的 API，前者需要传入 3 个参数：开头，结尾，数量；后者需要额外传入一个 base，它默认是 10。</p>
<p>⚠️ 需要注意的是：第三个参数并<strong>不是</strong>步长。</p>
<h4 id="np-linspace"><code>np.linspace</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 线性</span></span><br><span class="line">np.linspace(<span class="number">0</span>, <span class="number">9</span>, <span class="number">10</span>).reshape(<span class="number">2</span>, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0., 1., 2., 3., 4.],
       [5., 6., 7., 8., 9.]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.linspace(<span class="number">0</span>, <span class="number">9</span>, <span class="number">6</span>).reshape(<span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0. , 1.8, 3.6],
       [5.4, 7.2, 9. ]])
</code></pre>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指数 base 默认为 10</span></span><br><span class="line">np.logspace(<span class="number">0</span>, <span class="number">9</span>, <span class="number">6</span>, base=np.e).reshape(<span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[1.00000000e+00, 6.04964746e+00, 3.65982344e+01],
       [2.21406416e+02, 1.33943076e+03, 8.10308393e+03]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _ 表示上（最近）一个输出</span></span><br><span class="line"><span class="comment"># logspace 结果 log 后就是上面 linspace 的结果</span></span><br><span class="line">np.log(_)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0. , 1.8, 3.6],
       [5.4, 7.2, 9. ]])
</code></pre>
<p>下面我们更进一步看一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">N = <span class="number">20</span></span><br><span class="line">x = np.arange(N)</span><br><span class="line">y1 = np.linspace(<span class="number">0</span>, <span class="number">10</span>, N) * <span class="number">100</span></span><br><span class="line">y2 = np.logspace(<span class="number">0</span>, <span class="number">10</span>, N, base=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">plt.plot(x, y2, <span class="string">&#x27;*&#x27;</span>);</span><br><span class="line">plt.plot(x, y1, <span class="string">&#x27;o&#x27;</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/liwangshengya/picture/img/202202041437669.png" alt="png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查每个元素是否为 True</span></span><br><span class="line"><span class="comment"># base 的 指数为 linspace 得到的就是 logspace</span></span><br><span class="line">np.alltrue(<span class="number">2</span> ** np.linspace(<span class="number">0</span>, <span class="number">10</span>, N)  == y2)</span><br></pre></td></tr></table></figure>
<pre><code>True
</code></pre>
<blockquote>
<p>⚠️ 补充：关于 array 的条件判断</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不能直接用 if 判断 array 是否符合某个条件</span></span><br><span class="line">arr = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">cond1 = arr &gt; <span class="number">2</span></span><br><span class="line">cond1</span><br></pre></td></tr></table></figure>
<pre><code>array([False, False,  True])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> cond1:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;这不行&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

&lt;ipython-input-184-6bd8dc445309&gt; in &lt;module&gt;
----&gt; 1 if cond1:
      2     print(&quot;这不行&quot;)


ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 即便你全是 True 它也不行</span></span><br><span class="line">arr = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">cond2 = arr &gt; <span class="number">0</span></span><br><span class="line">cond2</span><br></pre></td></tr></table></figure>
<pre><code>array([ True,  True,  True])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> cond2:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;这还不行&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

&lt;ipython-input-187-7fedc8ba71a0&gt; in &lt;module&gt;
----&gt; 1 if cond2:
      2     print(&quot;这还不行&quot;)


ValueError: The truth value of an array with more than one element is ambiguous. Use a.any() or a.all()
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 咱们只能用 any 或 all，这个很容易犯错，请务必注意。</span></span><br><span class="line"><span class="keyword">if</span> cond1.<span class="built_in">any</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;只要有一个为True就可以，所以——我可以&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>只要有一个为True就可以，所以——我可以
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> cond2.<span class="built_in">all</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;所有值为True才可以，我正好这样&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>所有值为True才可以，我正好这样
</code></pre>
<h3 id="使用-ones-zeros-创建">使用 ones/zeros 创建</h3>
<p>⭐</p>
<p>创建全 1/0 array 的快捷方式。需要注意的是 <code>np.zeros_like</code> 或 <code>np.ones_like</code>，二者可以快速生成给定 array 一样 shape 的 0 或 1 向量，这在需要 Mask 某些位置时可能会用到。</p>
<p>⚠️ 需要注意的是：创建出来的 array 默认是 float 类型。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.ones(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([1., 1., 1.])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.ones((<span class="number">2</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[1., 1., 1.],
       [1., 1., 1.]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.zeros((<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]],

       [[0., 0., 0., 0.],
        [0., 0., 0., 0.],
        [0., 0., 0., 0.]]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 像给定向量那样的 0 向量（ones_like 是 1 向量）</span></span><br><span class="line">np.zeros_like(np.ones((<span class="number">2</span>,<span class="number">3</span>,<span class="number">3</span>)))</span><br></pre></td></tr></table></figure>
<pre><code>array([[[0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.]],

       [[0., 0., 0.],
        [0., 0., 0.],
        [0., 0., 0.]]])
</code></pre>
<h3 id="使用-random-生成">使用 random 生成</h3>
<p>⭐⭐⭐⭐⭐</p>
<p>如果要在这一节选一个最重要的 API，那一定是 <code>random</code> 无疑了，这里我们只介绍几个比较常用的「生产」数据相关的 API。它们经常用于随机生成训练或测试数据，神经网路初始化等。</p>
<p>⚠️ 需要注意的是：这里我们统一推荐使用新的 API 方式创建，即通过 <code>np.random.default_rng()</code> 先生成 <code>Generator</code>，然后再在此基础上生成各种分布的数据（记忆更加简便清晰）。不过我们依然会介绍就的 API 用法，因为很多代码中使用的还是旧的，您可以混个眼熟。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0-1 连续均匀分布</span></span><br><span class="line">np.random.rand(<span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.42508994, 0.5842191 , 0.09248675],
       [0.656858  , 0.88171822, 0.81744539]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单个数</span></span><br><span class="line">np.random.rand()</span><br></pre></td></tr></table></figure>
<pre><code>0.29322641374172986
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 0-1 连续均匀分布</span></span><br><span class="line">np.random.random((<span class="number">3</span>, <span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.17586271, 0.5061715 ],
       [0.14594537, 0.34365713],
       [0.28714656, 0.40508807]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定上下界的连续均匀分布</span></span><br><span class="line">np.random.uniform(-<span class="number">1</span>, <span class="number">1</span>, (<span class="number">2</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 0.66638982, -0.65327069, -0.21787878],
       [-0.63552782,  0.51072282, -0.14968825]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上面两个的区别是 shape 的输入方式不同，无伤大雅了</span></span><br><span class="line"><span class="comment"># 不过从 1.17 版本后推荐这样使用（以后大家可以用新的方法）</span></span><br><span class="line"><span class="comment"># rng 是个 Generator，可用于生成各种分布</span></span><br><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line">rng</span><br></pre></td></tr></table></figure>
<pre><code>Generator(PCG64) at 0x111B5C5E0
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 推荐的连续均匀分布用法</span></span><br><span class="line">rng.random((<span class="number">2</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.77395605, 0.43887844, 0.85859792],
       [0.69736803, 0.09417735, 0.97562235]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以指定上下界，所以更加推荐这种用法</span></span><br><span class="line">rng.uniform(<span class="number">0</span>, <span class="number">1</span>, (<span class="number">2</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.47673156, 0.59702442, 0.63523558],
       [0.68631534, 0.77560864, 0.05803685]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 随机整数（离散均匀分布），不超过给定的值（10）</span></span><br><span class="line">np.random.randint(<span class="number">10</span>, size=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([6, 3])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 随机整数（离散均匀分布），指定上下界和 shape</span></span><br><span class="line">np.random.randint(<span class="number">0</span>, <span class="number">10</span>, (<span class="number">2</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[8, 6, 1],
       [3, 8, 1]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上面推荐的方法，指定大小和上界</span></span><br><span class="line">rng.integers(<span class="number">10</span>, size=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([9, 7])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上面推荐的方法，指定上下界</span></span><br><span class="line">rng.integers(<span class="number">0</span>, <span class="number">10</span>, (<span class="number">2</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[5, 9, 1],
       [8, 5, 7]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标准正态分布</span></span><br><span class="line">np.random.randn(<span class="number">2</span>, <span class="number">4</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[-0.61241167, -0.55218849, -0.50470617, -1.35613877],
       [-1.34665975, -0.74064846, -2.5181665 ,  0.66866357]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上面推荐的标准正态分布用法</span></span><br><span class="line">rng.standard_normal((<span class="number">2</span>, <span class="number">4</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 0.09130331,  1.06124845, -0.79376776, -0.7004211 ],
       [ 0.71545457,  1.24926923, -1.22117522,  1.23336317]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 高斯分布</span></span><br><span class="line">np.random.normal(<span class="number">0</span>, <span class="number">1</span>, (<span class="number">3</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 0.30037773, -0.17462372,  0.23898533,  1.23235421,  0.90514996],
       [ 0.90269753, -0.5679421 ,  0.8769029 ,  0.81726869, -0.59442623],
       [ 0.31453468, -0.18190156, -2.95932929, -0.07164822, -0.23622439]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 上面推荐的高斯分布用法</span></span><br><span class="line">rng.normal(<span class="number">0</span>, <span class="number">1</span>, (<span class="number">3</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 2.20602146, -2.17590933,  0.80605092, -1.75363919,  0.08712213],
       [ 0.33164095,  0.33921626,  0.45251278, -0.03281331, -0.74066207],
       [-0.61835785, -0.56459129,  0.37724436, -0.81295739,  0.12044035]])
</code></pre>
<p>总之，一般会用的就是2个分布：均匀分布和正态（高斯）分布。另外，<code>size</code> 可以指定 shape。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 离散均匀分布</span></span><br><span class="line">rng.integers(low=<span class="number">0</span>, high=<span class="number">10</span>, size=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0, 7, 6, 4, 4])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 连续均匀分布</span></span><br><span class="line">rng.uniform(low=<span class="number">0</span>, high=<span class="number">10</span>, size=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([6.97368029, 0.94177348, 9.75622352, 7.61139702, 7.86064305])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正态（高斯）分布</span></span><br><span class="line">rng.normal(loc=<span class="number">0.0</span>, scale=<span class="number">1.0</span>, size=(<span class="number">2</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[-0.01680116, -0.85304393,  0.87939797],
       [ 0.77779194,  0.0660307 ,  1.12724121]])
</code></pre>
<h3 id="从文件读取">从文件读取</h3>
<p>⭐</p>
<p>这小节主要用于加载实现存储好的权重参数或预处理好的数据集，有时候会比较方便，比如训练好的模型参数加载到内存里用来提供推理服务，或者耗时很久的预处理数据直接存起来，多次实验时不需要重新处理。</p>
<p>⚠️ 需要注意的是：存储时不需要写文件名后缀，会自动添加。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接将给定矩阵存为 a.npy</span></span><br><span class="line">np.save(<span class="string">&#x27;./data/a&#x27;</span>, np.array([[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], [<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>]]))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以将多个矩阵存在一起，名为 `b.npz`</span></span><br><span class="line">np.savez(<span class="string">&quot;./data/b&quot;</span>, a=np.arange(<span class="number">12</span>).reshape(<span class="number">3</span>, <span class="number">4</span>), b=np.arange(<span class="number">12.</span>).reshape(<span class="number">4</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 和上一个一样，只是压缩了</span></span><br><span class="line">np.savez_compressed(<span class="string">&quot;./data/c&quot;</span>, a=np.arange(<span class="number">12</span>).reshape(<span class="number">3</span>, <span class="number">4</span>), b=np.arange(<span class="number">12.</span>).reshape(<span class="number">4</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载单个 array</span></span><br><span class="line">np.load(<span class="string">&quot;data/a.npy&quot;</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[1, 2, 3],
       [4, 5, 6]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载多个，可以像字典那样取出对应的 array</span></span><br><span class="line">arr = np.load(<span class="string">&quot;data/b.npz&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr[<span class="string">&quot;a&quot;</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr[<span class="string">&quot;b&quot;</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 0.,  1.,  2.],
       [ 3.,  4.,  5.],
       [ 6.,  7.,  8.],
       [ 9., 10., 11.]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 后缀都一样，你干脆当它和上面的没区别即可</span></span><br><span class="line">arr = np.load(<span class="string">&quot;data/c.npz&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr[<span class="string">&quot;b&quot;</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 0.,  1.,  2.],
       [ 3.,  4.,  5.],
       [ 6.,  7.,  8.],
       [ 9., 10., 11.]])
</code></pre>
<h2 id="统计和属性">统计和属性</h2>
<p>本节我们从 array 的基本统计属性入手，对刚刚创建的 array 进一步的了解。主要包括以下几个方面：</p>
<ul>
<li>尺寸相关</li>
<li>最大、最小、中位、分位值</li>
<li>平均、求和、标准差等</li>
</ul>
<p>都是描述性统计相关的指标，对于我们从整体了解一个 array 很有帮助。其中，用到最多的是尺寸相关的「<code>shape</code>」，最大、最小值，平均值、求和等。</p>
<p>本节的内容非常简单，您只需要特别关注（记住）两个重要的特性：</p>
<ul>
<li>按维度（指定 axis）求结果。一般0表示列1表示行，可以用「<strong>沿着行/列操作</strong>」这样理解，不确定时可以拿个例子试一下。</li>
<li>计算后保持维度（<code>keepdims=True</code>）</li>
</ul>
<p>另外，为了便于操作，我们使用一个随机生成的 array 作为操作对象；同时，我们指定了 seed，这样每次运行，每个人看到的结果都是一样的。一般我们在训练模型时，往往需要指定 seed，这样才能在「同等条件」下进行调参。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  先创建一个 Generator</span></span><br><span class="line">rng = np.random.default_rng(seed=<span class="number">42</span>)</span><br><span class="line"><span class="comment">#  再生成一个均匀分布</span></span><br><span class="line">arr = rng.uniform(<span class="number">0</span>, <span class="number">1</span>, (<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.77395605, 0.43887844, 0.85859792, 0.69736803],
       [0.09417735, 0.97562235, 0.7611397 , 0.78606431],
       [0.12811363, 0.45038594, 0.37079802, 0.92676499]])
</code></pre>
<h3 id="尺寸相关">尺寸相关</h3>
<p>⭐⭐</p>
<p>这一小节主要包括：维度、形状和数据量，其中形状 <code>shape</code> 我们用到的最多。</p>
<p>⚠️ 需要注意的是：size 不是 shape，ndim 表示有几个维度。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 维度，array 是二维的（两个维度）</span></span><br><span class="line">arr.ndim</span><br></pre></td></tr></table></figure>
<pre><code>2
</code></pre>
<h4 id="np-shape"><code>np.shape</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 形状，返回一个 Tuple</span></span><br><span class="line">arr.shape</span><br></pre></td></tr></table></figure>
<pre><code>(3, 4)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据量</span></span><br><span class="line">arr.size</span><br></pre></td></tr></table></figure>
<pre><code>12
</code></pre>
<h3 id="最值分位">最值分位</h3>
<p>⭐⭐⭐</p>
<p>这一小节主要包括：最大值、最小值、中位数、其他分位数，其中『<strong>最大值和最小值</strong>』我们平时用到的最多。</p>
<p>⚠️ 需要注意的是：分位数可以是 0-1 的任意小数（表示对应分位），而且分位数并不一定在原始的 array 中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.77395605, 0.43887844, 0.85859792, 0.69736803],
       [0.09417735, 0.97562235, 0.7611397 , 0.78606431],
       [0.12811363, 0.45038594, 0.37079802, 0.92676499]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 所有元素中最大的</span></span><br><span class="line">arr.<span class="built_in">max</span>()</span><br></pre></td></tr></table></figure>
<pre><code>0.9756223516367559
</code></pre>
<h4 id="np-max-min"><code>np.max/min</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按维度（列）最大值</span></span><br><span class="line">arr.<span class="built_in">max</span>(axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.77395605, 0.97562235, 0.85859792, 0.92676499])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同理，按行</span></span><br><span class="line">arr.<span class="built_in">max</span>(axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.85859792, 0.97562235, 0.92676499])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 是否保持原来的维度</span></span><br><span class="line"><span class="comment"># 这个需要特别注意下，很多深度学习模型中都需要保持原有的维度进行后续计算</span></span><br><span class="line"><span class="comment"># shape 是 (3,1)，array 的 shape 是 (3,4)，按行，同时保持了行的维度</span></span><br><span class="line">arr.<span class="built_in">min</span>(axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.43887844],
       [0.09417735],
       [0.12811363]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 保持维度：（1，4），原始array是（3，4）</span></span><br><span class="line">arr.<span class="built_in">min</span>(axis=<span class="number">0</span>, keepdims=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.09417735, 0.43887844, 0.37079802, 0.69736803]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一维了</span></span><br><span class="line">arr.<span class="built_in">min</span>(axis=<span class="number">0</span>, keepdims=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.09417735, 0.43887844, 0.37079802, 0.69736803])
</code></pre>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 另一种用法，不过我们一般习惯使用上面的用法，其实两者一回事</span></span><br><span class="line">np.amax(arr, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.77395605, 0.97562235, 0.85859792, 0.92676499])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同 amax</span></span><br><span class="line">np.amin(arr, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.43887844, 0.09417735, 0.12811363])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 中位数</span></span><br><span class="line"><span class="comment"># 其他用法和 max，min 是一样的</span></span><br><span class="line">np.median(arr)</span><br></pre></td></tr></table></figure>
<pre><code>0.7292538655248584
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分位数，按列取1/4数</span></span><br><span class="line">np.quantile(arr, q=<span class="number">0.25</span>, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.11114549, 0.44463219, 0.56596886, 0.74171617])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分位数，按行取 3/4，同时保持维度</span></span><br><span class="line">np.quantile(arr, q=<span class="number">0.75</span>, axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.79511652],
       [0.83345382],
       [0.5694807 ]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分位数，注意，分位数可以是 0-1 之间的任何数字（分位）</span></span><br><span class="line"><span class="comment"># 如果是 1/2 分位，那正好是中位数</span></span><br><span class="line">np.quantile(arr, q=<span class="number">1</span>/<span class="number">2</span>, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.73566204, 0.773602  , 0.41059198])
</code></pre>
<h3 id="平均求和标准差">平均求和标准差</h3>
<p>⭐⭐⭐</p>
<p>这一小节主要包括：平均值、累计求和、方差、标准差等进一步的统计指标。其中使用最多的是「平均值」。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.77395605, 0.43887844, 0.85859792, 0.69736803],
       [0.09417735, 0.97562235, 0.7611397 , 0.78606431],
       [0.12811363, 0.45038594, 0.37079802, 0.92676499]])
</code></pre>
<h4 id="np-average"><code>np.average</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 平均值</span></span><br><span class="line">np.average(arr)</span><br></pre></td></tr></table></figure>
<pre><code>0.6051555606435642
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按维度平均（列）</span></span><br><span class="line">np.average(arr, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.33208234, 0.62162891, 0.66351188, 0.80339911])
</code></pre>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 另一个计算平均值的 API</span></span><br><span class="line"><span class="comment"># 它与 average 的主要区别是，np.average 可以指定权重，即可以用于计算加权平均</span></span><br><span class="line"><span class="comment"># 一般建议使用 average，忘掉 mean 吧！</span></span><br><span class="line">np.mean(arr, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.33208234, 0.62162891, 0.66351188, 0.80339911])
</code></pre>
<h4 id="np-sum"><code>np.sum</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求和，不多说了，类似</span></span><br><span class="line">np.<span class="built_in">sum</span>(arr, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([2.76880044, 2.61700371, 1.87606258])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.<span class="built_in">sum</span>(arr, axis=<span class="number">1</span>, keepdims=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[2.76880044],
       [2.61700371],
       [1.87606258]])
</code></pre>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按列累计求和</span></span><br><span class="line">np.cumsum(arr, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.77395605, 0.43887844, 0.85859792, 0.69736803],
       [0.8681334 , 1.41450079, 1.61973762, 1.48343233],
       [0.99624703, 1.86488673, 1.99053565, 2.41019732]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按行累计求和</span></span><br><span class="line">np.cumsum(arr, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.77395605, 1.21283449, 2.07143241, 2.76880044],
       [0.09417735, 1.0697997 , 1.8309394 , 2.61700371],
       [0.12811363, 0.57849957, 0.94929759, 1.87606258]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 标准差，用法类似</span></span><br><span class="line">np.std(arr)</span><br></pre></td></tr></table></figure>
<pre><code>0.28783096517727075
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按列求标准差</span></span><br><span class="line">np.std(arr, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.3127589 , 0.25035525, 0.21076935, 0.09444968])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 方差</span></span><br><span class="line">np.var(arr, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0.02464271, 0.1114405 , 0.0839356 ])
</code></pre>
<h2 id="形状和转换">形状和转换</h2>
<p>array 大多数情况下都是以多维的形式出现的，一般对超过二维的多维 array 称为「张量」，二维矩阵，一维向量。因为多维度，所以自然而然地涉及到形状的改变和转换，可以算是张量最基础的「操作」了。</p>
<p>本节我们主要涉及以下三个方面：</p>
<ul>
<li>改变形状</li>
<li>反序</li>
<li>转置</li>
</ul>
<p>其中，改变形状和转置都非常常用，我们建议您熟练掌握。</p>
<h3 id="改变形状">改变形状</h3>
<p>⭐⭐⭐⭐⭐</p>
<p>这小节里面的 API 使用非常高频，尤其是扩展 1 维度的 <code>expand_dims</code> 和去除 1 维度的 <code>squeeze</code>，您未来会在很多神经网络架构中看到这俩货的身影。</p>
<p>⚠️ 需要注意的是：无论是扩展还是缩减，多或少的 shape 都是 1，<code>squeeze</code> 时如果指定维度，则该维度 shape 必须是 1。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 换个整数的随机 array</span></span><br><span class="line">rng = np.random.default_rng(seed=<span class="number">42</span>)</span><br><span class="line">arr = rng.integers(<span class="number">1</span>, <span class="number">100</span>, (<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65, 44],
       [43, 86,  9, 70],
       [20, 10, 53, 97]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 有时候您可能需要将多维 array 打平</span></span><br><span class="line">arr.ravel()</span><br></pre></td></tr></table></figure>
<pre><code>array([ 9, 77, 65, 44, 43, 86,  9, 70, 20, 10, 53, 97])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr.shape</span><br></pre></td></tr></table></figure>
<pre><code>(3, 4)
</code></pre>
<h4 id="np-expand-dims"><code>np.expand_dims</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### 扩展 1 个维度，需要（必须）指定维度</span></span><br><span class="line"><span class="comment"># 其实就是多嵌套了一下</span></span><br><span class="line">np.expand_dims(arr, <span class="number">1</span>).shape</span><br></pre></td></tr></table></figure>
<pre><code>(3, 1, 4)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 扩充维度</span></span><br><span class="line">expanded = np.expand_dims(arr, axis=(<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">expanded.shape</span><br></pre></td></tr></table></figure>
<pre><code>(3, 1, 4, 1, 1)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 扩充维度不能跳跃</span></span><br><span class="line">expanded = np.expand_dims(arr, axis=(<span class="number">1</span>, <span class="number">3</span>, <span class="number">8</span>))</span><br></pre></td></tr></table></figure>
<pre><code>---------------------------------------------------------------------------

AxisError                                 Traceback (most recent call last)

&lt;ipython-input-344-2c2510eb807f&gt; in &lt;module&gt;
      1 # 扩充维度不能跳跃
----&gt; 2 expanded = np.expand_dims(arr, axis=(1, 3, 8))


&lt;__array_function__ internals&gt; in expand_dims(*args, **kwargs)


/usr/local/lib/python3.8/site-packages/numpy/lib/shape_base.py in expand_dims(a, axis)
    595 
    596     out_ndim = len(axis) + a.ndim
--&gt; 597     axis = normalize_axis_tuple(axis, out_ndim)
    598 
    599     shape_it = iter(a.shape)


/usr/local/lib/python3.8/site-packages/numpy/core/numeric.py in normalize_axis_tuple(axis, ndim, argname, allow_duplicate)
   1356             pass
   1357     # Going via an iterator directly is slower than via list comprehension.
-&gt; 1358     axis = tuple([normalize_axis_index(ax, ndim, argname) for ax in axis])
   1359     if not allow_duplicate and len(set(axis)) != len(axis):
   1360         if argname:


/usr/local/lib/python3.8/site-packages/numpy/core/numeric.py in &lt;listcomp&gt;(.0)
   1356             pass
   1357     # Going via an iterator directly is slower than via list comprehension.
-&gt; 1358     axis = tuple([normalize_axis_index(ax, ndim, argname) for ax in axis])
   1359     if not allow_duplicate and len(set(axis)) != len(axis):
   1360         if argname:


AxisError: axis 8 is out of bounds for array of dimension 5
</code></pre>
<h4 id="np-squeeze"><code>np.squeeze</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># squeeze 指定 axis 的shape必须为1</span></span><br><span class="line">np.squeeze(expanded, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

&lt;ipython-input-345-8a712eef1189&gt; in &lt;module&gt;
      1 # squeeze 指定 axis 的shape必须为1
----&gt; 2 np.squeeze(expanded, axis=0)


&lt;__array_function__ internals&gt; in squeeze(*args, **kwargs)


/usr/local/lib/python3.8/site-packages/numpy/core/fromnumeric.py in squeeze(a, axis)
   1493         return squeeze()
   1494     else:
-&gt; 1495         return squeeze(axis=axis)
   1496 
   1497 


ValueError: cannot select an axis to squeeze out which has size not equal to one
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果指定了维度，那就只会去除该维度，指定的维度必须为 1</span></span><br><span class="line">np.squeeze(expanded, axis=<span class="number">1</span>).shape</span><br></pre></td></tr></table></figure>
<pre><code>(3, 3, 1, 1)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 去除所有维度为 1 的</span></span><br><span class="line">np.squeeze(expanded).shape</span><br></pre></td></tr></table></figure>
<pre><code>(3, 3)
</code></pre>
<h4 id="np-reshape-arr-reshape"><code>np.reshape/arr.reshape</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># reshape 成另一个形状</span></span><br><span class="line"><span class="comment"># 也可以直接变为一维向量</span></span><br><span class="line">arr.reshape(<span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[[ 9, 77, 65],
        [44, 43, 86]],

       [[ 9, 70, 20],
        [10, 53, 97]]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以偷懒，使用 -1 表示其他维度（此处 -1 为 3），注意，reshape 参数可以是 tuple 或连续整数</span></span><br><span class="line">arr1 = arr.reshape((<span class="number">4</span>, -<span class="number">1</span>))</span><br><span class="line">arr1</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86],
       [ 9, 70, 20],
       [10, 53, 97]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 元素数量必须与原array一致</span></span><br><span class="line">arr.reshape(<span class="number">3</span>, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

&lt;ipython-input-348-67f1d69569ea&gt; in &lt;module&gt;
      1 # 元素数量必须与原array一致
----&gt; 2 arr.reshape(3, 3)


ValueError: cannot reshape array of size 12 into shape (3,3)
</code></pre>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 另一种变换形状的方式 —— 原地变换</span></span><br><span class="line"><span class="comment"># 不过不能用-1</span></span><br><span class="line"><span class="comment"># 另外 resize 不一定和原来的元素数量一样多</span></span><br><span class="line">arr2 = arr.resize((<span class="number">4</span>, <span class="number">3</span>))</span><br><span class="line"><span class="comment"># 注意：上面的 reshape 会生成一个新的 array，但 resize 不会，所以我们需要用原变量名将它显示出来</span></span><br><span class="line"><span class="comment"># arr2 没有值</span></span><br><span class="line">arr2</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86],
       [ 9, 70, 20],
       [10, 53, 97]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接 resize，如果元素数量多时会提示错误</span></span><br><span class="line">arr.resize((<span class="number">2</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

&lt;ipython-input-351-a23c63ab1d76&gt; in &lt;module&gt;
      1 # 直接 resize，如果元素数量多时会提示错误
----&gt; 2 arr.resize((2, 3))


ValueError: cannot resize an array that references or is referenced
by another array in this way.
Use the np.resize function or refcheck=False
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以copy一份</span></span><br><span class="line">arrcopy = np.copy(arr)</span><br><span class="line">arrcopy.resize((<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">arrcopy</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># arr 保持不变</span></span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86],
       [ 9, 70, 20],
       [10, 53, 97]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 也可以将 refcheck 设为 False</span></span><br><span class="line"><span class="comment"># 此时 arr 会发生变化</span></span><br><span class="line"><span class="comment"># 元素数量超出时，截断；元素数量不够时，0填充</span></span><br><span class="line">arr.resize((<span class="number">2</span>,<span class="number">3</span>), refcheck=<span class="literal">False</span>)</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">arr.resize((<span class="number">3</span>, <span class="number">3</span>), refcheck=<span class="literal">False</span>)</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86],
       [ 0,  0,  0]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86],
       [ 0,  0,  0]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如果用 np.resize 会略有不同</span></span><br><span class="line"><span class="comment"># 元素数量不够时，会自动复制</span></span><br><span class="line">np.resize(arr, (<span class="number">5</span>, <span class="number">3</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86],
       [ 0,  0,  0],
       [ 9, 77, 65],
       [44, 43, 86]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 元素数量多出来时，会自动截断</span></span><br><span class="line">np.resize(arr, (<span class="number">2</span>, <span class="number">2</span>))</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77],
       [65, 44]])
</code></pre>
<h3 id="反序">反序</h3>
<p>⭐</p>
<p>也可以看作是一种对原数组的转换，用的不多，可以了解一下，为接下来的索引和切片做个热身。</p>
<p>如果给一个字符串或数组让您反序，您可能会想到很多种方法，比如：<code>reversed</code>，或者写一个方法，或者用 Python list 的索引功能，而这也是 <code>numpy</code> 中 array 反序的方式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 字符串</span></span><br><span class="line">s = <span class="string">&quot;uevol&quot;</span></span><br><span class="line">s[::-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>'loveu'
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数组</span></span><br><span class="line">lst = [<span class="number">1</span>, <span class="string">&quot;1&quot;</span>, <span class="number">5.2</span>]</span><br><span class="line">lst[::-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>[5.2, '1', 1]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86],
       [ 9, 70, 20],
       [10, 53, 97]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86],
       [ 9, 70, 20],
       [10, 53, 97]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 我们按上面的套路：默认列反序</span></span><br><span class="line">arr[::-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[10, 53, 97],
       [ 9, 70, 20],
       [44, 43, 86],
       [ 9, 77, 65]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列不变行反序</span></span><br><span class="line">arr[::-<span class="number">1</span>, :]</span><br></pre></td></tr></table></figure>
<pre><code>array([[10, 53, 97],
       [ 9, 70, 20],
       [44, 43, 86],
       [ 9, 77, 65]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在不同维度上操作：行不变列反序</span></span><br><span class="line">arr[:, ::-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[65, 77,  9],
       [86, 43, 44],
       [20, 70,  9],
       [97, 53, 10]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 行变列也变</span></span><br><span class="line">arr[::-<span class="number">1</span>, ::-<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[97, 53, 10],
       [20, 70,  9],
       [86, 43, 44],
       [65, 77,  9]])
</code></pre>
<h3 id="转置">转置</h3>
<p>⭐⭐⭐</p>
<p>转置是线性代数的基本操作，拿二维矩阵为例，通俗理解就是把它放倒，shape 反转，行变成列，列成为行。当然，对于多维也是类似的。我们建议您二维矩阵用 <code>arr.T</code>（会快很多），超过二维的张量可以用 <code>np.transpose</code>，会更加灵活些。</p>
<p>⚠️ 需要注意的是：一维数组转置还是自己。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 一维</span></span><br><span class="line">np.array([<span class="number">1</span>,<span class="number">2</span>]).T.shape</span><br></pre></td></tr></table></figure>
<pre><code>(2,)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65],
       [44, 43, 86],
       [ 9, 70, 20],
       [10, 53, 97]])
</code></pre>
<h4 id="arr-T"><code>arr.T</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 简便用法，把所有维度顺序都给倒过来</span></span><br><span class="line">arr.T</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 44,  9, 10],
       [77, 43, 70, 53],
       [65, 86, 20, 97]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将 shape=(1,1,3,4) 的转置后得到 shape=(4,3,1,1)</span></span><br><span class="line">arr.reshape(<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>).T.shape</span><br></pre></td></tr></table></figure>
<pre><code>(4, 3, 1, 1)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同上</span></span><br><span class="line">arr.reshape(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>).T.shape</span><br></pre></td></tr></table></figure>
<pre><code>(1, 3, 1, 2, 2, 1)
</code></pre>
<h4 id="np-transpose"><code>np.transpose</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这种转置方式可以指定 axes</span></span><br><span class="line">np.transpose(arr)</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 44,  9, 10],
       [77, 43, 70, 53],
       [65, 86, 20, 97]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不指定 axes 时和 .T 是一样的</span></span><br><span class="line">np.transpose(arr.reshape(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">1</span>)).shape</span><br></pre></td></tr></table></figure>
<pre><code>(1, 3, 1, 2, 2, 1)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 指定 axes，不过 axes 数量必须包含所有维度的序列</span></span><br><span class="line"><span class="comment"># 比如两个维度就是 (0, 1)，四个就是 (0, 1, 2, 3)</span></span><br><span class="line"><span class="comment"># 当然，顺序可以改变，比如下面就是只转置第 2 个和第 3 个维度</span></span><br><span class="line"><span class="comment"># 注意，只有超过 2 维时，这样才有意义</span></span><br><span class="line"><span class="comment"># 下面的结果中，中间2个维度被调换顺序了，顺序就在axes中指定的</span></span><br><span class="line">np.transpose(arr.reshape(<span class="number">1</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>), axes=(<span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>)).shape</span><br></pre></td></tr></table></figure>
<pre><code>(1, 3, 1, 4)
</code></pre>
<h2 id="分解和组合-2">分解和组合</h2>
<p>这节我们主要学习 array 的分解和组合，本节是所有章节中最重要的一节，通过本节内容，您可以充分了解 <code>numpy</code>（以及 Python 语言）的强大，这种操作上的优雅不能说后无来者，但至少前无古人了。</p>
<p>内容大致包括以下小节：</p>
<ul>
<li>切片和索引</li>
<li>拼接</li>
<li>重复</li>
<li>分拆</li>
</ul>
<p>其中，重中之重是「切片和索引」，它基础、它高频、它无处不在。我们强烈建议您熟练掌握，其他三个相对简单，只需要各记住一个 API 即可。</p>
<h3 id="切片和索引">切片和索引</h3>
<p>⭐⭐⭐⭐⭐</p>
<p>划重点！切片和索引是通过对已有 array 进行操作而得到想要的「部分」元素的行为过程。其核心动作可以概括为：按维度根据 <code>start:stop:step</code> 操作 array。</p>
<p>这部分内容的核心是把处理按维度分开，不处理的维度统一用 <code>:</code> 或 <code>...</code> 代替；在看操作时，也要首先关注「<code>,</code>」在哪里。要处理的维度和之前 <code>arange</code> <code>linspace</code> 等接口使用方法是一样的。</p>
<p>⚠️ 需要注意的是：引支持负数，即从后往前索引。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line">arr = rng.integers(<span class="number">0</span>, <span class="number">20</span>, (<span class="number">5</span>, <span class="number">4</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 1, 15, 13,  8],
       [ 8, 17,  1, 13],
       [ 4,  1, 10, 19],
       [14, 15, 14, 15],
       [10,  2, 16,  9]])
</code></pre>
<h4 id="index-slice"><code>index/slice</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最简单的索引，取第 0 行</span></span><br><span class="line">arr[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([ 1, 15, 13,  8])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 最简单的切片，取第 0 行第 1 个元素</span></span><br><span class="line">arr[<span class="number">0</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>15
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 然后带点范围 第 1-2 行</span></span><br><span class="line">arr[<span class="number">0</span>:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 1, 15, 13,  8],
       [ 8, 17,  1, 13],
       [ 4,  1, 10, 19]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 离散也可以：第 1，3 行</span></span><br><span class="line">arr[[<span class="number">0</span>, <span class="number">3</span>]]</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 1, 15, 13,  8],
       [14, 15, 14, 15]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 1, 15, 13,  8],
       [ 8, 17,  1, 13],
       [ 4,  1, 10, 19],
       [14, 15, 14, 15],
       [10,  2, 16,  9]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 再来加上维度：第 1-2 行，第 1 列</span></span><br><span class="line">arr[<span class="number">1</span>:<span class="number">3</span>, <span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([17,  1])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 离散也是一样：第 1，3 行，第 0 列</span></span><br><span class="line">arr[[<span class="number">1</span>,<span class="number">3</span>], [<span class="number">0</span>]]</span><br></pre></td></tr></table></figure>
<pre><code>array([ 8, 14])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 还可以有简写：到最后或到开始。如第 3 行到最后一行</span></span><br><span class="line">arr[<span class="number">3</span>:]</span><br></pre></td></tr></table></figure>
<pre><code>array([[14, 15, 14, 15],
       [10,  2, 16,  9]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开始到第 3 行，第 1-3 列</span></span><br><span class="line">arr[:<span class="number">3</span>, <span class="number">1</span>:<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[15, 13],
       [17,  1],
       [ 1, 10]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 还可以来点跳跃，步长：start:stop:step，第 1 行到第 4 行，间隔为 2，即第 1、3 行</span></span><br><span class="line">arr[<span class="number">1</span>: <span class="number">4</span>: <span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 8, 17,  1, 13],
       [14, 15, 14, 15]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加上列也可以哦，第 1、3 行，第 0、2 列</span></span><br><span class="line">arr[<span class="number">1</span>:<span class="number">4</span>:<span class="number">2</span>, <span class="number">0</span>:<span class="number">3</span>:<span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 8,  1],
       [14, 14]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 1, 15, 13,  8],
       [ 8, 17,  1, 13],
       [ 4,  1, 10, 19],
       [14, 15, 14, 15],
       [10,  2, 16,  9]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一列的值，其实是所有其他维度第 1 维的值</span></span><br><span class="line">arr[...,<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([15, 17,  1, 15,  2])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 与上面类似，但用的更多</span></span><br><span class="line">arr[:,<span class="number">1</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([15, 17,  1, 15,  2])
</code></pre>
<h3 id="拼接">拼接</h3>
<p>⭐⭐⭐⭐</p>
<p>有时候我们需要对已有的几个 array 进行拼接以形成一个大的 array（常见的例子比如不同类型特征的拼接）。本小节严格来说只有两个 API：<code>np.concatenate</code> 和 <code>np.stack</code>，前者是拼接，后者是堆叠（会增加一个维度），都可以指定维度。记住，有它俩就够了。</p>
<p>⚠️ 需要注意的是：<code>hstack</code> 和 <code>vstack</code> 和 <code>stack</code> 没关系，反而是 <code>concatenate</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line"></span><br><span class="line">arr1 = rng.random((<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">arr2 = rng.random((<span class="number">2</span>, <span class="number">3</span>))</span><br><span class="line">arr1, arr2</span><br></pre></td></tr></table></figure>
<pre><code>(array([[0.77395605, 0.43887844, 0.85859792],
        [0.69736803, 0.09417735, 0.97562235]]),
 array([[0.7611397 , 0.78606431, 0.12811363],
        [0.45038594, 0.37079802, 0.92676499]]))
</code></pre>
<h4 id="np-concatenate"><code>np.concatenate</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认沿axis=0（列）连接</span></span><br><span class="line">np.concatenate((arr1, arr2))</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.77395605, 0.43887844, 0.85859792],
       [0.69736803, 0.09417735, 0.97562235],
       [0.7611397 , 0.78606431, 0.12811363],
       [0.45038594, 0.37079802, 0.92676499]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 沿 axis=1（行）连接</span></span><br><span class="line">np.concatenate((arr1, arr2), axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.77395605, 0.43887844, 0.85859792, 0.7611397 , 0.78606431,
        0.12811363],
       [0.69736803, 0.09417735, 0.97562235, 0.45038594, 0.37079802,
        0.92676499]])
</code></pre>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 竖直按行顺序拼接</span></span><br><span class="line"><span class="comment"># 注意：vstack 虽然看起来是 stack，但其实它是 concatenate，建议您只使用 `np.concatenate`</span></span><br><span class="line">np.vstack((arr1, arr2))</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.77395605, 0.43887844, 0.85859792],
       [0.69736803, 0.09417735, 0.97562235],
       [0.7611397 , 0.78606431, 0.12811363],
       [0.45038594, 0.37079802, 0.92676499]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 水平按列顺序拼接</span></span><br><span class="line"><span class="comment"># 道理和 vstack 一样，建议使用 `np.concatenate` axis=1</span></span><br><span class="line">np.hstack((arr1, arr2))</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.77395605, 0.43887844, 0.85859792, 0.7611397 , 0.78606431,
        0.12811363],
       [0.69736803, 0.09417735, 0.97562235, 0.45038594, 0.37079802,
        0.92676499]])
</code></pre>
<h4 id="np-stack"><code>np.stack</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 堆叠，默认根据 axis=0 进行</span></span><br><span class="line">np.stack((arr1, arr2))</span><br></pre></td></tr></table></figure>
<pre><code>array([[[0.77395605, 0.43887844, 0.85859792],
        [0.69736803, 0.09417735, 0.97562235]],

       [[0.7611397 , 0.78606431, 0.12811363],
        [0.45038594, 0.37079802, 0.92676499]]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_.shape</span><br></pre></td></tr></table></figure>
<pre><code>(2, 2, 3)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 堆叠，根据 axis=2</span></span><br><span class="line">np.stack((arr1, arr2), axis=<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[[0.77395605, 0.7611397 ],
        [0.43887844, 0.78606431],
        [0.85859792, 0.12811363]],

       [[0.69736803, 0.45038594],
        [0.09417735, 0.37079802],
        [0.97562235, 0.92676499]]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># _ 表示上一个 Cell 的输出结果</span></span><br><span class="line">_.shape</span><br></pre></td></tr></table></figure>
<pre><code>(2, 3, 2)
</code></pre>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 纵深按 axis=2 堆叠，不管它就行，我们认准 `stack`</span></span><br><span class="line">np.dstack((arr1, arr2))</span><br></pre></td></tr></table></figure>
<pre><code>array([[[0.77395605, 0.7611397 ],
        [0.43887844, 0.78606431],
        [0.85859792, 0.12811363]],

       [[0.69736803, 0.45038594],
        [0.09417735, 0.37079802],
        [0.97562235, 0.92676499]]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_.shape</span><br></pre></td></tr></table></figure>
<pre><code>(2, 3, 2)
</code></pre>
<h3 id="重复">重复</h3>
<p>⭐⭐⭐</p>
<p>重复其实是另一种拼接方式，它也可以指定要重复的维度。在有些深度学习模型数据构建中非常有用（方便）。</p>
<p>⚠️ 需要注意的是：是一个维度一个维度依次重复，而不是整个 array 重复。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line">arr = rng.integers(<span class="number">0</span>, <span class="number">10</span>, (<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[0, 7, 6, 4],
       [4, 8, 0, 6],
       [2, 0, 5, 9]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 axis=0（沿着列）上重复 2 次</span></span><br><span class="line">np.repeat(arr, <span class="number">2</span>, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0, 7, 6, 4],
       [0, 7, 6, 4],
       [4, 8, 0, 6],
       [4, 8, 0, 6],
       [2, 0, 5, 9],
       [2, 0, 5, 9]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 axis=1（沿着行）上重复 3 次</span></span><br><span class="line">np.repeat(arr, <span class="number">3</span>, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0, 0, 0, 7, 7, 7, 6, 6, 6, 4, 4, 4],
       [4, 4, 4, 8, 8, 8, 0, 0, 0, 6, 6, 6],
       [2, 2, 2, 0, 0, 0, 5, 5, 5, 9, 9, 9]])
</code></pre>
<h3 id="分拆">分拆</h3>
<p>⭐⭐⭐</p>
<p>有拼接堆叠自然就有拆分，注意这不是切片和索引，就是将 array 拆成想要的几份。用的不是特别多，API 只要记住 <code>np.split</code> 就行了，其他的都是快捷方式。</p>
<p>⚠️ 需要注意的是：分拆的 axis 是对该维度进行拆分。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line">arr = rng.integers(<span class="number">1</span>, <span class="number">100</span>, (<span class="number">6</span>, <span class="number">4</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65, 44],
       [43, 86,  9, 70],
       [20, 10, 53, 97],
       [73, 76, 72, 78],
       [51, 13, 84, 45],
       [50, 37, 19, 92]])
</code></pre>
<h4 id="np-split"><code>np.split</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认切分列（axis=0），切成 3 份</span></span><br><span class="line">np.split(arr, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>[array([[ 9, 77, 65, 44],
        [43, 86,  9, 70]]),
 array([[20, 10, 53, 97],
        [73, 76, 72, 78]]),
 array([[51, 13, 84, 45],
        [50, 37, 19, 92]])]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># （axis=1）切分行</span></span><br><span class="line">np.split(arr, <span class="number">2</span>, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>[array([[ 9, 77],
        [43, 86],
        [20, 10],
        [73, 76],
        [51, 13],
        [50, 37]]),
 array([[65, 44],
        [ 9, 70],
        [53, 97],
        [72, 78],
        [84, 45],
        [19, 92]])]
</code></pre>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 和上面的一个效果</span></span><br><span class="line">np.vsplit(arr, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>[array([[ 9, 77, 65, 44],
        [43, 86,  9, 70]]),
 array([[20, 10, 53, 97],
        [73, 76, 72, 78]]),
 array([[51, 13, 84, 45],
        [50, 37, 19, 92]])]
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 等价的用法</span></span><br><span class="line">np.hsplit(arr, <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<pre><code>[array([[ 9, 77],
        [43, 86],
        [20, 10],
        [73, 76],
        [51, 13],
        [50, 37]]),
 array([[65, 44],
        [ 9, 70],
        [53, 97],
        [72, 78],
        [84, 45],
        [19, 92]])]
</code></pre>
<h2 id="筛选和过滤-2">筛选和过滤</h2>
<p>这小节与索引和切片有点类似，但倾向于从「整体」中统一筛选出「符合条件」的内容，而索引和切片更多的是依照「某种方法」切出一块内容。本小节内容同样非常重要，可以算第二个最重要的小节。主要包括以下内容：</p>
<ul>
<li>条件筛选</li>
<li>提取（按条件）</li>
<li>抽样（按分布）</li>
<li>最大最小 index（特殊值）</li>
</ul>
<p>这几个内容都很重要，使用的也非常高频。条件筛选经常用于 Mask 或异常值处理，提取则常用于结果过滤，抽样常用在数据生成（比如负样本抽样），最大最小 index 则常见于机器学习模型预测结果判定中（根据最大概率所在的 index 决定结果属于哪一类）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line">arr = rng.integers(<span class="number">1</span>, <span class="number">100</span>, (<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65, 44],
       [43, 86,  9, 70],
       [20, 10, 53, 97]])
</code></pre>
<h3 id="条件筛选">条件筛选</h3>
<p>⭐⭐⭐</p>
<p>顾名思义，根据一定的条件对 array 进行筛选（标记）并后续处理。核心 API 是 <code>np.where</code>。</p>
<p>⚠️ 需要注意的是：where 分别返回各维度的 index，赋值的是「不满足」条件的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 条件筛选，可以直接在整个 array 上使用条件</span></span><br><span class="line">arr &gt; <span class="number">50</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[False,  True,  True, False],
       [False,  True, False,  True],
       [False, False,  True,  True]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 返回满足条件的索引，因为是两个维度，所以会返回两组结果</span></span><br><span class="line">np.where(arr &gt; <span class="number">50</span>)</span><br></pre></td></tr></table></figure>
<pre><code>(array([0, 0, 1, 1, 2, 2]), array([1, 2, 1, 3, 2, 3]))
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不满足条件的赋值，将 &lt;=50 的替换为 -1</span></span><br><span class="line">np.where(arr &gt; <span class="number">50</span>, arr, -<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[-1, 77, 65, -1],
       [-1, 86, -1, 70],
       [-1, -1, 53, 97]])
</code></pre>
<h3 id="提取">提取</h3>
<p>⭐</p>
<p>在 array 中提取指定条件的值。</p>
<p>⚠️ 需要注意的是：提取和唯一值返回的都是一维向量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提取指定条件的值</span></span><br><span class="line">np.extract(arr &gt; <span class="number">50</span>, arr)</span><br></pre></td></tr></table></figure>
<pre><code>array([77, 65, 86, 70, 53, 97])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 唯一值，是另一种形式的提取</span></span><br><span class="line">np.unique(arr)</span><br></pre></td></tr></table></figure>
<pre><code>array([ 9, 10, 20, 43, 44, 53, 65, 70, 77, 86, 97])
</code></pre>
<h3 id="抽样">抽样</h3>
<p>⭐⭐⭐⭐⭐</p>
<p>我们在跑模型时常常需要使用部分数据对整个过程快速验证，您当然可以使用 <code>np.random</code> 生成模拟数据。但有真实数据时，从真实数据中随机抽样会比较好。</p>
<p>⚠️ 需要注意的是：抽样的集合要求为一维向量（一般是数据的 index）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line"><span class="comment"># 第一个参数是要抽样的集合，如果是一个整数，则表示从 0 到该值</span></span><br><span class="line"><span class="comment"># 第二个参数是样本大小</span></span><br><span class="line"><span class="comment"># 第三个参数表示结果是否可以重复</span></span><br><span class="line"><span class="comment"># 第四个参数表示出现的概率，长度和第一个参数一样</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 由于（0 1 2 3）中 2 和 3 的概率比较高，自然就选择了 2 和 3</span></span><br><span class="line">rng.choice(<span class="number">4</span>, <span class="number">2</span>, replace=<span class="literal">False</span>, p=[<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.4</span>])</span><br></pre></td></tr></table></figure>
<pre><code>array([3, 2])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 旧的 API</span></span><br><span class="line"><span class="comment"># 如果是抽样语料的 index，更多的方法是这样：</span></span><br><span class="line">data_size = <span class="number">10000</span></span><br><span class="line">np.random.choice(data_size, <span class="number">50</span>, replace=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([6339, 4894, 1531, 7814,  224, 9538, 9619, 3801, 3359, 3617, 2795,
       6627, 8501, 1681, 4212, 5085, 2439,  744, 9123, 6733, 5688, 5480,
       6983, 7058,  310, 1838, 5072,  746, 5873, 9372, 5953, 4944, 1780,
        464, 1247,  845, 1807, 7354, 4925,  547, 2996, 3909, 7344, 9617,
       8642,  661, 2453, 5475,  228, 2427])
</code></pre>
<h3 id="最值-Index">最值 Index</h3>
<p>⭐⭐⭐⭐⭐</p>
<p>这小节主要是两个 API：<code>np.argmax(min)</code> 和 <code>np.argsort</code>，当然最常用的还是第一个，不用说，自然是可以（需要）指定 axis 的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line">arr = rng.uniform(<span class="number">1</span>, <span class="number">100</span>, (<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[77.62164881, 44.44896554, 86.00119407, 70.03943488],
       [10.32355744, 97.58661281, 76.3528305 , 78.82036622],
       [13.68324963, 45.58820785, 37.7090044 , 92.7497339 ]])
</code></pre>
<h4 id="np-argmax-argmin"><code>np.argmax/argmin</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 所有值中最大值的 Index，基本不这么用</span></span><br><span class="line">np.argmax(arr)</span><br></pre></td></tr></table></figure>
<pre><code>5
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按列（axis=0）最大值的 Index</span></span><br><span class="line">np.argmax(arr, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([0, 1, 0, 2])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按行（axis=1）最小值的 Index</span></span><br><span class="line">np.argmin(arr, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([1, 0, 0])
</code></pre>
<h4 id="np-argsort"><code>np.argsort</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[77.62164881, 44.44896554, 86.00119407, 70.03943488],
       [10.32355744, 97.58661281, 76.3528305 , 78.82036622],
       [13.68324963, 45.58820785, 37.7090044 , 92.7497339 ]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认按行（axis=1）排序的索引</span></span><br><span class="line">np.argsort(arr)</span><br></pre></td></tr></table></figure>
<pre><code>array([[1, 3, 0, 2],
       [0, 2, 3, 1],
       [0, 2, 1, 3]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据按行（axis=1）排序的索引，同上</span></span><br><span class="line">np.argsort(arr, axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[1, 3, 0, 2],
       [0, 2, 3, 1],
       [0, 2, 1, 3]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据按列（axis=0）排序索引</span></span><br><span class="line">np.argsort(arr, axis=<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[1, 0, 2, 0],
       [2, 2, 1, 1],
       [0, 1, 0, 2]])
</code></pre>
<h2 id="矩阵和运算">矩阵和运算</h2>
<p>这一节我们将聚焦矩阵和相关的运算，主要包括：</p>
<ul>
<li>算术（四则运算及其他基础算术）</li>
<li>广播</li>
<li>矩阵相关</li>
</ul>
<p>这些内容其实使用非常普遍，普遍到我们甚至都不会察觉到自己在使用，而且也非常简单。当然，高纬度的计算我们这里并不涉及，但逻辑是一致的，只是更加复杂。</p>
<h3 id="算术">算术</h3>
<p>⭐⭐⭐⭐</p>
<p>所有的算术函数均可直接运用于 array。</p>
<p>⚠️ 需要注意的是：<code>mod</code> 运算可以指定多个被除数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line">arr = rng.integers(<span class="number">1</span>, <span class="number">20</span>, (<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 2, 15, 13,  9],
       [ 9, 17,  2, 14],
       [ 4,  2, 11, 19]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># +-*/ 四则运算，就跟两个数字计算一样</span></span><br><span class="line">arr * <span class="number">2</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[ 4, 30, 26, 18],
       [18, 34,  4, 28],
       [ 8,  4, 22, 38]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 平方也可以</span></span><br><span class="line">arr ** <span class="number">2</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[  4, 225, 169,  81],
       [ 81, 289,   4, 196],
       [ 16,   4, 121, 361]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开方</span></span><br><span class="line">np.sqrt(arr)</span><br></pre></td></tr></table></figure>
<pre><code>array([[1.41421356, 3.87298335, 3.60555128, 3.        ],
       [3.        , 4.12310563, 1.41421356, 3.74165739],
       [2.        , 1.41421356, 3.31662479, 4.35889894]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># log</span></span><br><span class="line">np.log(arr)</span><br></pre></td></tr></table></figure>
<pre><code>array([[0.69314718, 2.7080502 , 2.56494936, 2.19722458],
       [2.19722458, 2.83321334, 0.69314718, 2.63905733],
       [1.38629436, 0.69314718, 2.39789527, 2.94443898]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 超过5的都换成5</span></span><br><span class="line">np.minimum(arr, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[2, 5, 5, 5],
       [5, 5, 2, 5],
       [4, 2, 5, 5]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 低于5的都换成5</span></span><br><span class="line">np.maximum(arr, <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 5, 15, 13,  9],
       [ 9, 17,  5, 14],
       [ 5,  5, 11, 19]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 四舍五入</span></span><br><span class="line">np.<span class="built_in">round</span>(np.sqrt(arr), <span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[1.41, 3.87, 3.61, 3.  ],
       [3.  , 4.12, 1.41, 3.74],
       [2.  , 1.41, 3.32, 4.36]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># floor/ceil</span></span><br><span class="line">np.floor(np.sqrt(arr))</span><br></pre></td></tr></table></figure>
<pre><code>array([[1., 3., 3., 3.],
       [3., 4., 1., 3.],
       [2., 1., 3., 4.]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">np.ceil(np.sqrt(arr))</span><br></pre></td></tr></table></figure>
<pre><code>array([[2., 4., 4., 3.],
       [3., 5., 2., 4.],
       [2., 2., 4., 5.]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 2, 15, 13,  9],
       [ 9, 17,  2, 14],
       [ 4,  2, 11, 19]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mod &lt;=&gt; x % 3</span></span><br><span class="line">np.mod(arr, <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[2, 0, 1, 0],
       [0, 2, 2, 2],
       [1, 2, 2, 1]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr-<span class="number">5</span></span><br></pre></td></tr></table></figure>
<pre><code>array([[-3, 10,  8,  4],
       [ 4, 12, -3,  9],
       [-1, -3,  6, 14]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 还可以使用多个被除数</span></span><br><span class="line">np.mod(arr, arr-<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<pre><code>array([[-1,  5,  5,  1],
       [ 1,  5, -1,  5],
       [ 0, -1,  5,  5]])
</code></pre>
<blockquote>
<p>关于广播</p>
</blockquote>
<p><code>numpy</code> 处理不同形状的 array 时使用的手段，极大地方便了使用者。在计算过程中，较小的数组会在较大的数组上进行「广播」，以便适配对方的形状。</p>
<p>⚠️ 需要注意的是：广播需要满足对应的形状。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line">a = rng.integers(<span class="number">1</span>, <span class="number">100</span>, (<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">a</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 9, 77, 65, 44],
       [43, 86,  9, 70],
       [20, 10, 53, 97]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 广播，后面的被当做 1 行 4 列</span></span><br><span class="line">a + [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 10,  79,  68,  48],
       [ 44,  88,  12,  74],
       [ 21,  12,  56, 101]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 或者这样广播，后面的被当做 3 行 1 列</span></span><br><span class="line">a + [[<span class="number">1</span>], [<span class="number">2</span>], [<span class="number">3</span>]]</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 10,  78,  66,  45],
       [ 45,  88,  11,  72],
       [ 23,  13,  56, 100]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 之前的取余也是可以的</span></span><br><span class="line">np.mod(a, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br></pre></td></tr></table></figure>
<pre><code>array([[0, 1, 2, 0],
       [0, 0, 0, 2],
       [0, 0, 2, 1]])
</code></pre>
<h3 id="矩阵">矩阵</h3>
<p>⭐⭐⭐⭐⭐</p>
<p>这一小节主要介绍线性代数中矩阵的处理，我们会介绍几个矩阵相关常用的 API。</p>
<p>⚠️ 需要注意的是：<code>dot</code> 和 <code>matmul</code> 在高维度时表现不同。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rng = np.random.default_rng(<span class="number">42</span>)</span><br><span class="line">a = rng.integers(<span class="number">1</span>, <span class="number">10</span>, (<span class="number">3</span>, <span class="number">2</span>))</span><br><span class="line">b = rng.integers(<span class="number">1</span>, <span class="number">10</span>, (<span class="number">2</span>, <span class="number">4</span>))</span><br><span class="line">c = rng.integers(<span class="number">1</span>, <span class="number">10</span>, (<span class="number">3</span>, <span class="number">3</span>))</span><br><span class="line">a, b, c</span><br></pre></td></tr></table></figure>
<pre><code>(array([[1, 7],
        [6, 4],
        [4, 8]]),
 array([[1, 7, 2, 1],
        [5, 9, 7, 7]]),
 array([[7, 8, 5],
        [2, 8, 5],
        [5, 4, 2]]))
</code></pre>
<h4 id="arr-dot"><code>arr.dot</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># array 乘法</span></span><br><span class="line">np.dot(a, b)</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 36,  70,  51,  50],
       [ 26,  78,  40,  34],
       [ 44, 100,  64,  60]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 或者这样乘</span></span><br><span class="line">a.dot(b)</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 36,  70,  51,  50],
       [ 26,  78,  40,  34],
       [ 44, 100,  64,  60]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 我们看下高维度下 dot 和 matmul 的区别</span></span><br><span class="line"><span class="comment"># ijk, lkm -&gt; ijlm</span></span><br><span class="line">np.dot(np.ones((<span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>)), np.ones((<span class="number">4</span>, <span class="number">3</span>, <span class="number">6</span>))).shape</span><br></pre></td></tr></table></figure>
<pre><code>(5, 2, 4, 6)
</code></pre>
<h4 id="np-matmul"><code>np.matmul</code></h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 矩阵乘法</span></span><br><span class="line"><span class="comment"># 与 dot 的主要区别是：如果维度 &gt; 2，dot 只考虑最后的维度，而 matmul 则考虑所有维度</span></span><br><span class="line">np.matmul(a, b)</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 36,  70,  51,  50],
       [ 26,  78,  40,  34],
       [ 44, 100,  64,  60]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同上，写起来比较好看的方法</span></span><br><span class="line">a @ b</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 36,  70,  51,  50],
       [ 26,  78,  40,  34],
       [ 44, 100,  64,  60]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ijk, ikl -&gt; ijl</span></span><br><span class="line">np.matmul(np.ones((<span class="number">5</span>, <span class="number">2</span>, <span class="number">3</span>)), np.ones((<span class="number">4</span>, <span class="number">3</span>, <span class="number">6</span>))).shape</span><br></pre></td></tr></table></figure>
<pre><code>---------------------------------------------------------------------------

ValueError                                Traceback (most recent call last)

&lt;ipython-input-95-a5c509c4e8f1&gt; in &lt;module&gt;
      1 # ijk, ikl -&gt; ijl
----&gt; 2 np.matmul(np.ones((5, 2, 3)), np.ones((4, 3, 6))).shape


ValueError: operands could not be broadcast together with remapped shapes [original-&gt;remapped]: (5,2,3)-&gt;(5,newaxis,newaxis) (4,3,6)-&gt;(4,newaxis,newaxis) and requested shape (2,6)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ijk, ikl -&gt; ijl</span></span><br><span class="line">np.matmul(np.ones((<span class="number">4</span>, <span class="number">2</span>, <span class="number">3</span>)), np.ones((<span class="number">4</span>, <span class="number">3</span>, <span class="number">6</span>))).shape</span><br></pre></td></tr></table></figure>
<pre><code>(4, 2, 6)
</code></pre>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 点积</span></span><br><span class="line">np.vdot(a, a)</span><br></pre></td></tr></table></figure>
<pre><code>182
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对，就是点积</span></span><br><span class="line">np.<span class="built_in">sum</span>(a*a)</span><br></pre></td></tr></table></figure>
<pre><code>182
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内积</span></span><br><span class="line">np.inner(a, a)</span><br></pre></td></tr></table></figure>
<pre><code>array([[50, 34, 60],
       [34, 52, 56],
       [60, 56, 80]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对，就是内积</span></span><br><span class="line">a.dot(a.T)</span><br></pre></td></tr></table></figure>
<pre><code>array([[50, 34, 60],
       [34, 52, 56],
       [60, 56, 80]])
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 行列式</span></span><br><span class="line">np.linalg.det(c)</span><br></pre></td></tr></table></figure>
<pre><code>-19.999999999999996
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 逆矩阵（方阵）</span></span><br><span class="line">np.linalg.inv(c)</span><br></pre></td></tr></table></figure>
<pre><code>array([[ 0.2 , -0.2 ,  0.  ],
       [-1.05,  0.55,  1.25],
       [ 1.6 , -0.6 , -2.  ]])
</code></pre>
<h2 id="小结和心得">小结和心得</h2>
<p>恭喜您学完了 Numpy《从小白到入门》的教程，相信有此基础您在日后足以应付绝大部分的使用场景。如果您还想继续深入学习 Numpy，欢迎关注我们后续课程《从入门到精通》，在那里，我们将深入 <code>numpy</code> 内部细节，对其原理进行系统、全面的介绍。期待我们后会有期。</p>
<h3 id="内容小结">内容小结</h3>
<p>本教程共六个部分，我们给您把最重要的（3个⭐以上的）一些 API 罗列出来供您回忆，加深印象：</p>
<ul>
<li>创建和生成
<ul>
<li><code>np.linspace(start, end, nums)</code></li>
<li><code>rng.integers/uniform(low, high, size)</code></li>
<li><code>rng.normal(loc, scale, size)</code></li>
</ul>
</li>
<li>统计和属性
<ul>
<li><code>arr.shape</code></li>
<li><code>arr.sum/max/min(axis, keepdims)</code></li>
<li><code>np.average(arr, axis)</code></li>
</ul>
</li>
<li>形状和转换
<ul>
<li><code>arr.reshpae/np.reshape</code></li>
<li><code>np.expand_dims(arr, axis)</code></li>
<li><code>np.squeeze(arr axis)</code></li>
<li><code>np.transpose(arr, axis)</code></li>
<li><code>arr.T</code></li>
</ul>
</li>
<li>分解和组合
<ul>
<li><code>arr[start:stop:step, ...]</code></li>
<li><code>np.concatenate((arr1, arr2), axis)</code></li>
<li><code>np.stack((arr1, arr2), axis)</code></li>
<li><code>np.repeat(arr, repeat_num, axis)</code></li>
<li><code>np.split(arr, part_num, axis)</code></li>
</ul>
</li>
<li>筛选和过滤
<ul>
<li><code>np.where(condition, arr, replaced_val)</code></li>
<li><code>rng.choice(a, size, replace=False, p=probs_size_equals_a)</code></li>
<li><code>rng.argmax/argmin/argsort(arr, axis)</code></li>
</ul>
</li>
<li>矩阵和计算
<ul>
<li><code>+-*/</code></li>
<li><code>np.dot(a, b) == a.dot(b)</code></li>
<li><code>np.matmul(a, b) == a @ b</code></li>
</ul>
</li>
</ul>
<h3 id="心得技巧">心得技巧</h3>
<ul>
<li>生成/查看 array 时，注意具体的数据类型</li>
<li>很多 API 都有 axis，将它理解为「沿着」或「对」某一维度进行操作就很容易理解了</li>
</ul>
<h2 id="巩固和练习">巩固和练习</h2>
<p>接下来，是时候对学到的成果进行一番检验了，为此我们给您准备了两个小菜和一分多餐，请尽情享用。</p>
<p>背景描述：使用 iris 数据集，target 选择 0 和 1（setosa, versicolor），丢弃 2（我们只用二分类就可以了）</p>
<h3 id="基础题目1">基础题目1</h3>
<p>切分数据，要求如下：</p>
<ul>
<li>针对每一 target，分别按 80%/20% 将数据切分为训练数据和测试数据</li>
<li>切分时要求每 5 个样本，取中间的 1 个为测试数据，其余为训练数据</li>
</ul>
<h3 id="基础题目2">基础题目2</h3>
<p>预测结果，要求如下：</p>
<ul>
<li>加载预先在训练数据上训练好的权重参数（存储参数的方法：<code>np.savez(&quot;data/weight&quot;, weight=weight)</code>）</li>
<li>使用模型 <code>sigmoid(W·X)</code> 对测试数据进行预测</li>
<li>输出预测的准确率</li>
</ul>
<h3 id="进阶题目">进阶题目</h3>
<p>如果您已经对机器学习有了一定基础，不妨试试这个练习，它会使用更多 <code>numpy</code> 的 API。</p>
<p>使用 Numpy 实现简单神经网络，要求如下：</p>
<ul>
<li>特征选择第 2 个和第 4 个（sepal width, petal width）</li>
<li>使用反向传播和梯度下降进行学习</li>
</ul>
<p>提示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 数据集</span></span><br><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br><span class="line"></span><br><span class="line">iris = load_iris()</span><br><span class="line">data = iris[<span class="string">&quot;data&quot;</span>]</span><br><span class="line">target = iris[<span class="string">&quot;target&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Sigmoid</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sigmoid</span>(<span class="params">x: np.array, derive: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; np.array:</span><br><span class="line">    <span class="keyword">if</span> derive:</span><br><span class="line">        <span class="keyword">return</span> x * (<span class="number">1</span> - x)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x))</span><br></pre></td></tr></table></figure>
<h2 id="解答和参考">解答和参考</h2>
<p>以下是练习题的参考解答。既然是参考，那就一定不是标准，您可以使用任意方式实现最终的目的得到答案。如果您愿意，使用 for 循环也是可以的，但如果最终的答案不对，还是需要重新检查一下。我们特别重视和关注过程，但结果更加重要，条条道路通罗马，咱最后得到罗马不是？</p>
<p>最后再引用《Unix 编程艺术》中的一个观点：先让程序「正确地」运行起来。完成&gt;完美，健康才能快乐。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sigmoid</span>(<span class="params">x: np.array, derive: <span class="built_in">bool</span> = <span class="literal">False</span></span>) -&gt; np.array:</span><br><span class="line">    <span class="comment"># 求导数（用于反向传播）</span></span><br><span class="line">    <span class="keyword">if</span> derive:</span><br><span class="line">        <span class="keyword">return</span> x * (<span class="number">1</span> - x)</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span> / (<span class="number">1</span> + np.exp(-x))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets <span class="keyword">import</span> load_iris</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载 iris 数据集</span></span><br><span class="line">iris = load_iris()</span><br><span class="line"><span class="comment"># 提取 target ≤ 1 的 target，并将维度从 (length, ) 拓展为 (length, 1)</span></span><br><span class="line">y = np.expand_dims(np.extract(iris[<span class="string">&quot;target&quot;</span>] &lt;= <span class="number">1</span>, iris[<span class="string">&quot;target&quot;</span>]), <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 根据 y 的 size 拿到对应的 x</span></span><br><span class="line">x = iris[<span class="string">&quot;data&quot;</span>][:y.shape[<span class="number">0</span>]]</span><br></pre></td></tr></table></figure>
<h3 id="基础题目1-2">基础题目1</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 有多少条数据</span></span><br><span class="line">data_size = x.shape[<span class="number">0</span>]</span><br><span class="line"><span class="comment"># 20% 作为测试数据</span></span><br><span class="line">test_size = <span class="built_in">int</span>(data_size * <span class="number">0.2</span>)</span><br><span class="line"><span class="comment"># 找到测试数据的 index</span></span><br><span class="line">test_idx = [<span class="number">2</span> + i*<span class="number">5</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(test_size)]</span><br><span class="line"><span class="comment"># 过滤掉测试数据的 index，剩下的就是训练数据的 index</span></span><br><span class="line">train_idx = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data_size) <span class="keyword">if</span> i <span class="keyword">not</span> <span class="keyword">in</span> test_idx]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用训练数据的 index 得到训练数据</span></span><br><span class="line">x_train = x[train_idx]</span><br><span class="line">y_train = y[train_idx]</span><br><span class="line"><span class="comment"># 直接使用索引切片得到测试数据，当然也可以使用测试数据 index</span></span><br><span class="line">x_test = x[<span class="number">2</span>: data_size : <span class="number">5</span>]</span><br><span class="line">y_test = y[<span class="number">2</span>: data_size : <span class="number">5</span>]</span><br></pre></td></tr></table></figure>
<h3 id="基础题目2-2">基础题目2</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 预测函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">predict</span>(<span class="params">x, w</span>):</span><br><span class="line">    <span class="keyword">return</span> sigmoid(x.dot(w))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 加载权重，注意 key=&quot;weight&quot;</span></span><br><span class="line">w = np.load(<span class="string">&quot;./data/weight.npz&quot;</span>)[<span class="string">&quot;weight&quot;</span>]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拿到 sigmoid 的结果，即 probability</span></span><br><span class="line">prob = predict(x_test, w)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &gt;（或 ≥）0.5 作为 1 或 0 的标准</span></span><br><span class="line"><span class="built_in">sum</span>((prob &gt; <span class="number">0.5</span>) == y_test) / <span class="built_in">len</span>(y_test)</span><br></pre></td></tr></table></figure>
<pre><code>array([1.])
</code></pre>
<h3 id="进阶题目-2">进阶题目</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 只取第2和第4个特征</span></span><br><span class="line">x_train_part = x_train[:, [<span class="number">1</span>, <span class="number">3</span>]]</span><br><span class="line">x_test_part = x_test[:, [<span class="number">1</span>, <span class="number">3</span>]]</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">test</span>(<span class="params">x, y, wh, wo, use_hidden: <span class="built_in">bool</span> = <span class="literal">False</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    预测函数，如果使用隐层的话，需要增加对应的计算</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> use_hidden:</span><br><span class="line">        ypred = sigmoid(sigmoid(x.dot(wh)).dot(wo))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        ypred = sigmoid(x.dot(wo))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Acc: %.2f&quot;</span> % (<span class="built_in">sum</span>((ypred &gt;= <span class="number">0.5</span> ) == y) / <span class="built_in">len</span>(y))[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">x, y, use_hidden: <span class="built_in">bool</span> = <span class="literal">False</span>, lr: <span class="built_in">float</span> = <span class="number">0.01</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    训练函数，可以支持单隐层或无隐层</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    hidden_size = <span class="number">8</span> <span class="keyword">if</span> use_hidden <span class="keyword">else</span> x.shape[<span class="number">1</span>]</span><br><span class="line">    <span class="comment"># 初始化，可以有多种初始化方式，我们这里使用 uniform</span></span><br><span class="line">    wh = np.random.uniform(-np.sqrt(<span class="number">1</span>/hidden_size), np.sqrt(<span class="number">1</span>/hidden_size), (x.shape[<span class="number">1</span>], hidden_size))</span><br><span class="line">    wo = np.random.uniform(-<span class="number">1</span>, <span class="number">1</span>, (hidden_size, <span class="number">1</span>))</span><br><span class="line">    <span class="comment"># 1000 个 Epoch</span></span><br><span class="line">    <span class="keyword">for</span> epoch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">1001</span>):</span><br><span class="line">        <span class="comment"># 使用隐层</span></span><br><span class="line">        <span class="keyword">if</span> use_hidden:</span><br><span class="line">            hidden = np.dot(x, wh)</span><br><span class="line">            hidden = sigmoid(hidden)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            hidden = x</span><br><span class="line">        logits = np.dot(hidden, wo)</span><br><span class="line">        pred = sigmoid(logits)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 输出层的 error</span></span><br><span class="line">        pred_err = y - pred</span><br><span class="line">        <span class="comment"># 反向传播，输出层的更新权重</span></span><br><span class="line">        pred_delta = pred_err * sigmoid(pred, <span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">if</span> use_hidden:</span><br><span class="line">            <span class="comment"># 隐层的 error 和更新权重</span></span><br><span class="line">            hidd_err = pred_delta.dot(wo.T)</span><br><span class="line">            hidd_delta = hidd_err * sigmoid(hidden, <span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 更新参数</span></span><br><span class="line">        wo += lr * hidden.T.dot(pred_delta)</span><br><span class="line">        <span class="keyword">if</span> use_hidden:</span><br><span class="line">            wh += lr * x.T.dot(hidd_delta)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 计算损失</span></span><br><span class="line">        loss = np.mean(np.<span class="built_in">abs</span>(pred_err))</span><br><span class="line">        <span class="keyword">if</span> epoch % <span class="number">200</span> == <span class="number">0</span>:</span><br><span class="line">            <span class="comment"># 如果有验证集，可以在这里对验证集进行验证，结果有提升（如 loss下降或 acc 提高）时进行存储</span></span><br><span class="line">            <span class="comment"># 还可以根据结果提升情况设计自动提前终止的方案（比如连续 3 次不再提升）</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Error:&quot;</span> + <span class="built_in">str</span>(loss))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 得到训练集的 Acc</span></span><br><span class="line">    test(x, y, wh, wo, use_hidden)</span><br><span class="line">    <span class="comment"># 返回权重（参数）</span></span><br><span class="line">    <span class="keyword">return</span> wh, wo</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wh, wo = train(x_train_part, y_train)</span><br></pre></td></tr></table></figure>
<pre><code>Error:0.12291230663724437
Error:0.08282596392702782
Error:0.06586770282341464
Error:0.056016204876575326
Error:0.049407934168643926
Acc: 1.00
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test(x_test_part, y_test, wh, wo)</span><br></pre></td></tr></table></figure>
<pre><code>Acc: 1.00
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wh, wo = train(x_train_part, y_train, <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>Error:0.16416415380726673
Error:0.08236885703184059
Error:0.058163838923958065
Error:0.04626498346103437
Error:0.03903864391270989
Acc: 1.00
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test(x_test_part, y_test, wh, wo, <span class="literal">True</span>)</span><br></pre></td></tr></table></figure>
<pre><code>Acc: 1.00
</code></pre>
<h2 id="文献和资料">文献和资料</h2>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.runoob.com/numpy/numpy-tutorial.html">NumPy 教程 | 菜鸟教程</a></li>
<li><a target="_blank" rel="noopener" href="https://www.numpy.org.cn/">NumPy 中文</a></li>
</ul>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Numpy/">Numpy</a><a class="post-meta__tags" href="/tags/%E7%A7%91%E5%AD%A6%E8%AE%A1%E7%AE%97%E5%BA%93/">科学计算库</a><a class="post-meta__tags" href="/tags/Python/">Python</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/p/d7acd9bb.html"><img class="prev-cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">pandas(大水文)</div></div></a></div><div class="next-post pull-right"><a href="/p/ab9e1965.html"><img class="next-cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">git基本操作</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/p/d7acd9bb.html" title="pandas(大水文)"><img class="cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-02-05</div><div class="title">pandas(大水文)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/liwangsheng.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">李忘生</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">36</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">52</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">9</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/liwangshengya"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/liwangshengya" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/yxliwangsheng@outlook.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://t.me/wangshengya" target="_blank" title="Telegrame"><i class="fa-brands fa-telegram"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">1.</span> <span class="toc-text">基本操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%BC%E5%8C%85"><span class="toc-number">1.0.0.0.1.</span> <span class="toc-text">导包</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8E%E5%88%97%E8%A1%A8%E6%88%96%E5%85%83%E7%BB%84%E4%B8%AD%E5%88%9B%E5%BB%BA"><span class="toc-number">1.0.0.0.2.</span> <span class="toc-text">从列表或元组中创建</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8arange%E7%94%9F%E6%88%90"><span class="toc-number">1.0.0.0.3.</span> <span class="toc-text">使用arange生成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8linespace-logspace%E7%94%9F%E6%88%90"><span class="toc-number">1.0.0.0.4.</span> <span class="toc-text">使用linespace&#x2F;logspace生成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E7%BB%84%E5%BD%A2%E7%8A%B6"><span class="toc-number">1.0.0.0.5.</span> <span class="toc-text">数组形状</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#one-zeros%E5%88%9B%E5%BB%BA"><span class="toc-number">1.0.0.0.6.</span> <span class="toc-text">one&#x2F;zeros创建</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8random%E7%94%9F%E6%88%90"><span class="toc-number">1.0.0.0.7.</span> <span class="toc-text">使用random生成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B1%82%E5%B9%B3%E5%9D%87%E5%80%BC%E5%92%8C%E6%A0%87%E5%87%86%E5%B7%AE"><span class="toc-number">1.0.0.0.8.</span> <span class="toc-text">求平均值和标准差</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F%E5%92%8C%E8%BD%AC%E7%BD%AE"><span class="toc-number">1.0.0.0.9.</span> <span class="toc-text">反序和转置</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E8%A7%A3%E5%92%8C%E7%BB%84%E5%90%88"><span class="toc-number">1.0.0.0.10.</span> <span class="toc-text">分解和组合</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8B%86%E5%88%86"><span class="toc-number">1.0.0.0.11.</span> <span class="toc-text">拆分</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AD%9B%E9%80%89%E5%92%8C%E8%BF%87%E6%BB%A4"><span class="toc-number">1.0.0.0.12.</span> <span class="toc-text">筛选和过滤</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%80%E5%80%BC%E7%B4%A2%E5%BC%95"><span class="toc-number">1.0.0.0.13.</span> <span class="toc-text">最值索引</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E8%BF%90%E7%AE%97"><span class="toc-number">1.0.0.0.14.</span> <span class="toc-text">矩阵运算</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95"><span class="toc-number">1.0.0.0.15.</span> <span class="toc-text">矩阵乘法</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text">原文件</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E7%94%9F%E6%88%90"><span class="toc-number">2.1.</span> <span class="toc-text">创建和生成</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E-python-%E5%88%97%E8%A1%A8%E6%88%96%E5%85%83%E7%BB%84%E5%88%9B%E5%BB%BA"><span class="toc-number">2.1.1.</span> <span class="toc-text">从 python 列表或元组创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-arange-%E7%94%9F%E6%88%90"><span class="toc-number">2.1.2.</span> <span class="toc-text">使用 arange 生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-linspace-logspace-%E7%94%9F%E6%88%90"><span class="toc-number">2.1.3.</span> <span class="toc-text">使用 linspace&#x2F;logspace 生成</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#np-linspace"><span class="toc-number">2.1.3.1.</span> <span class="toc-text">np.linspace</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-ones-zeros-%E5%88%9B%E5%BB%BA"><span class="toc-number">2.1.4.</span> <span class="toc-text">使用 ones&#x2F;zeros 创建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-random-%E7%94%9F%E6%88%90"><span class="toc-number">2.1.5.</span> <span class="toc-text">使用 random 生成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">2.1.6.</span> <span class="toc-text">从文件读取</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%9F%E8%AE%A1%E5%92%8C%E5%B1%9E%E6%80%A7"><span class="toc-number">2.2.</span> <span class="toc-text">统计和属性</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%BA%E5%AF%B8%E7%9B%B8%E5%85%B3"><span class="toc-number">2.2.1.</span> <span class="toc-text">尺寸相关</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#np-shape"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">np.shape</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%80%BC%E5%88%86%E4%BD%8D"><span class="toc-number">2.2.2.</span> <span class="toc-text">最值分位</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#np-max-min"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">np.max&#x2F;min</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B9%B3%E5%9D%87%E6%B1%82%E5%92%8C%E6%A0%87%E5%87%86%E5%B7%AE"><span class="toc-number">2.2.3.</span> <span class="toc-text">平均求和标准差</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#np-average"><span class="toc-number">2.2.3.1.</span> <span class="toc-text">np.average</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#np-sum"><span class="toc-number">2.2.3.2.</span> <span class="toc-text">np.sum</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BD%A2%E7%8A%B6%E5%92%8C%E8%BD%AC%E6%8D%A2"><span class="toc-number">2.3.</span> <span class="toc-text">形状和转换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E5%BD%A2%E7%8A%B6"><span class="toc-number">2.3.1.</span> <span class="toc-text">改变形状</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#np-expand-dims"><span class="toc-number">2.3.1.1.</span> <span class="toc-text">np.expand_dims</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#np-squeeze"><span class="toc-number">2.3.1.2.</span> <span class="toc-text">np.squeeze</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#np-reshape-arr-reshape"><span class="toc-number">2.3.1.3.</span> <span class="toc-text">np.reshape&#x2F;arr.reshape</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%BA%8F"><span class="toc-number">2.3.2.</span> <span class="toc-text">反序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BD%AC%E7%BD%AE"><span class="toc-number">2.3.3.</span> <span class="toc-text">转置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#arr-T"><span class="toc-number">2.3.3.1.</span> <span class="toc-text">arr.T</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#np-transpose"><span class="toc-number">2.3.3.2.</span> <span class="toc-text">np.transpose</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E8%A7%A3%E5%92%8C%E7%BB%84%E5%90%88-2"><span class="toc-number">2.4.</span> <span class="toc-text">分解和组合</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%87%E7%89%87%E5%92%8C%E7%B4%A2%E5%BC%95"><span class="toc-number">2.4.1.</span> <span class="toc-text">切片和索引</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#index-slice"><span class="toc-number">2.4.1.1.</span> <span class="toc-text">index&#x2F;slice</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8B%BC%E6%8E%A5"><span class="toc-number">2.4.2.</span> <span class="toc-text">拼接</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#np-concatenate"><span class="toc-number">2.4.2.1.</span> <span class="toc-text">np.concatenate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#np-stack"><span class="toc-number">2.4.2.2.</span> <span class="toc-text">np.stack</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%87%8D%E5%A4%8D"><span class="toc-number">2.4.3.</span> <span class="toc-text">重复</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%8B%86"><span class="toc-number">2.4.4.</span> <span class="toc-text">分拆</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#np-split"><span class="toc-number">2.4.4.1.</span> <span class="toc-text">np.split</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AD%9B%E9%80%89%E5%92%8C%E8%BF%87%E6%BB%A4-2"><span class="toc-number">2.5.</span> <span class="toc-text">筛选和过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%A1%E4%BB%B6%E7%AD%9B%E9%80%89"><span class="toc-number">2.5.1.</span> <span class="toc-text">条件筛选</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%90%E5%8F%96"><span class="toc-number">2.5.2.</span> <span class="toc-text">提取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8A%BD%E6%A0%B7"><span class="toc-number">2.5.3.</span> <span class="toc-text">抽样</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%80%BC-Index"><span class="toc-number">2.5.4.</span> <span class="toc-text">最值 Index</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#np-argmax-argmin"><span class="toc-number">2.5.4.1.</span> <span class="toc-text">np.argmax&#x2F;argmin</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#np-argsort"><span class="toc-number">2.5.4.2.</span> <span class="toc-text">np.argsort</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5%E5%92%8C%E8%BF%90%E7%AE%97"><span class="toc-number">2.6.</span> <span class="toc-text">矩阵和运算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%97%E6%9C%AF"><span class="toc-number">2.6.1.</span> <span class="toc-text">算术</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9F%A9%E9%98%B5"><span class="toc-number">2.6.2.</span> <span class="toc-text">矩阵</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#arr-dot"><span class="toc-number">2.6.2.1.</span> <span class="toc-text">arr.dot</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#np-matmul"><span class="toc-number">2.6.2.2.</span> <span class="toc-text">np.matmul</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93%E5%92%8C%E5%BF%83%E5%BE%97"><span class="toc-number">2.7.</span> <span class="toc-text">小结和心得</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E5%AE%B9%E5%B0%8F%E7%BB%93"><span class="toc-number">2.7.1.</span> <span class="toc-text">内容小结</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%83%E5%BE%97%E6%8A%80%E5%B7%A7"><span class="toc-number">2.7.2.</span> <span class="toc-text">心得技巧</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%A9%E5%9B%BA%E5%92%8C%E7%BB%83%E4%B9%A0"><span class="toc-number">2.8.</span> <span class="toc-text">巩固和练习</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE1"><span class="toc-number">2.8.1.</span> <span class="toc-text">基础题目1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE2"><span class="toc-number">2.8.2.</span> <span class="toc-text">基础题目2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E9%A2%98%E7%9B%AE"><span class="toc-number">2.8.3.</span> <span class="toc-text">进阶题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E7%AD%94%E5%92%8C%E5%8F%82%E8%80%83"><span class="toc-number">2.9.</span> <span class="toc-text">解答和参考</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE1-2"><span class="toc-number">2.9.1.</span> <span class="toc-text">基础题目1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E9%A2%98%E7%9B%AE2-2"><span class="toc-number">2.9.2.</span> <span class="toc-text">基础题目2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9B%E9%98%B6%E9%A2%98%E7%9B%AE-2"><span class="toc-number">2.9.3.</span> <span class="toc-text">进阶题目</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E7%8C%AE%E5%92%8C%E8%B5%84%E6%96%99"><span class="toc-number">2.10.</span> <span class="toc-text">文献和资料</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/p/a3d799f8.html" title="安装wslg fedora后一些配置"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="安装wslg fedora后一些配置"/></a><div class="content"><a class="title" href="/p/a3d799f8.html" title="安装wslg fedora后一些配置">安装wslg fedora后一些配置</a><time datetime="2023-04-30T15:53:19.000Z" title="发表于 2023-04-30 23:53:19">2023-04-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/1780c53d.html" title="MySQL进阶篇3(锁，InnoDB引擎)"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL进阶篇3(锁，InnoDB引擎)"/></a><div class="content"><a class="title" href="/p/1780c53d.html" title="MySQL进阶篇3(锁，InnoDB引擎)">MySQL进阶篇3(锁，InnoDB引擎)</a><time datetime="2023-01-03T14:52:17.000Z" title="发表于 2023-01-03 22:52:17">2023-01-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/80edd4eb.html" title="MySQL进阶篇2(视图，存储过程，触发器)"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL进阶篇2(视图，存储过程，触发器)"/></a><div class="content"><a class="title" href="/p/80edd4eb.html" title="MySQL进阶篇2(视图，存储过程，触发器)">MySQL进阶篇2(视图，存储过程，触发器)</a><time datetime="2023-01-03T14:46:06.000Z" title="发表于 2023-01-03 22:46:06">2023-01-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/711b1718.html" title="MySQL进阶篇1(存储引擎，索引，优化)"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL进阶篇1(存储引擎，索引，优化)"/></a><div class="content"><a class="title" href="/p/711b1718.html" title="MySQL进阶篇1(存储引擎，索引，优化)">MySQL进阶篇1(存储引擎，索引，优化)</a><time datetime="2022-12-31T14:12:16.000Z" title="发表于 2022-12-31 22:12:16">2022-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/p/337fcc87.html" title="MySQL基础篇"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="MySQL基础篇"/></a><div class="content"><a class="title" href="/p/337fcc87.html" title="MySQL基础篇">MySQL基础篇</a><time datetime="2022-12-27T03:51:45.000Z" title="发表于 2022-12-27 11:51:45">2022-12-27</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2023 By 李忘生</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">welcome to my blog!😊</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><script src="https://cdn.jsdelivr.net/npm/algoliasearch/dist/algoliasearch-lite.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instantsearch.js/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>